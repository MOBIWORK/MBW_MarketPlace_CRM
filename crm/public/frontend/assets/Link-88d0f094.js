import{r as N,cQ as Z,b4 as W,A as w,w as U,aC as X,e as n,l as E,i,h,j as r,ay as Y,at as g,au as $,av as S,v as b,n as A,f as m,x as B,H,aF as I,aE as ee,aG as te,F as R,k as G,q as j,aH as ae,E as se,aJ as J,aK as le,aD as K,B as re,d as Q}from"./index-b29292c2.js";const oe={class:"w-full"},ue=["onClick"],ne={class:"flex items-center"},ie={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},de={key:1,class:"text-base leading-5 text-gray-500"},ce={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},pe={class:"relative px-1.5 pt-0.5"},me={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},fe={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-gray-600"},ye={key:0,class:"border-t p-1.5 pb-0.5"},he={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup(D,{expose:F,emit:d}){const s=D,u=d,c=N(""),x=N(!1),z=N(null),k=Z(),_=W(),L=w(()=>"value"in k),C=w({get(){return L.value?k.value:s.modelValue},set(e){c.value="",e&&(x.value=!1),u(L.value?"change":"update:modelValue",e)}});function O(){x.value=!1}const t=w(()=>{var a;return!s.options||s.options.length==0?[]:((a=s.options[0])!=null&&a.group?s.options:[{group:"",items:s.options}]).map((l,o)=>({key:o,group:l.group,hideLabel:l.hideLabel||!1,items:s.filterable?f(l.items):l.items})).filter(l=>l.items.length>0)});function f(e){return c.value?e.filter(a=>[a.label,a.value].some(o=>(o||"").toString().toLowerCase().includes(c.value.toLowerCase()))):e}function y(e){if(typeof e=="string"){let l=t.value.flatMap(o=>o.items).find(o=>o.value===e);return(l==null?void 0:l.label)||e}return e==null?void 0:e.label}U(c,e=>{u("update:query",e)}),U(x,e=>{e&&X(()=>{z.value.el.focus()})});const V=w(()=>s.disabled?"text-gray-600":"text-gray-800"),p=w(()=>{let e={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[s.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[s.size],l=s.disabled?"disabled":s.variant,o={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",s.variant==="outline"?"border-gray-300":"border-transparent"]}[l];return[e,a,o,V.value,"transition-colors w-full"]});return F({query:c}),(e,a)=>(n(),E(r(le),{modelValue:C.value,"onUpdate:modelValue":a[3]||(a[3]=l=>C.value=l),nullable:""},{default:i(({open:l})=>[h(r(Y),{class:"w-full",show:x.value,"onUpdate:show":a[2]||(a[2]=o=>x.value=o)},{target:i(({open:o,togglePopover:P})=>[g(e.$slots,"target",$(S({open:o,togglePopover:P})),()=>[b("div",oe,[b("button",{class:A(["flex w-full items-center justify-between focus:outline-none",p.value]),onClick:()=>P()},[b("div",ne,[g(e.$slots,"prefix"),C.value?(n(),m("span",ie,B(y(C.value)),1)):(n(),m("span",de,B(D.placeholder||""),1))]),h(r(H),{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,ue)])])]),body:i(({isOpen:o})=>{var P;return[I(b("div",null,[b("div",ce,[b("div",pe,[h(r(ee),{ref_key:"search",ref:z,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=v=>{c.value=v.target.value}),value:c.value,autocomplete:"off",placeholder:e.__("Search")},null,8,["value","placeholder"]),b("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=v=>C.value=null)},[h(r(H),{name:"x",class:"w-4"})])]),h(r(te),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:i(()=>[(n(!0),m(R,null,G(t.value,v=>I((n(),m("div",{class:"mt-1.5",key:v.key},[v.group&&!v.hideLabel?(n(),m("div",me,B(v.group),1)):j("",!0),(n(!0),m(R,null,G(v.items,q=>(n(),E(r(ae),{as:"template",key:q.value,value:q},{default:i(({active:T,selected:M})=>[b("li",{class:A(["flex items-center rounded px-2.5 py-1.5 text-base",{"bg-gray-100":T}])},[g(e.$slots,"item-prefix",$(S({active:T,selected:M,option:q}))),g(e.$slots,"item-label",$(S({active:T,selected:M,option:q})),()=>[se(B(q.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[J,v.items.length>0]])),128)),t.value.length==0?(n(),m("li",fe,B(e.__("No results found")),1)):j("",!0)]),_:3}),r(_).footer?(n(),m("div",ye,[g(e.$slots,"footer",$(S({value:(P=z.value)==null?void 0:P.el._value,close:O})))])):j("",!0)])],512),[[J,o]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},ve={class:"space-y-1.5"},be={key:0},xe={__name:"Link",props:{doctype:{type:String,required:!0},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(D,{emit:F}){const d=D,s=F,u=Z(),c=w(()=>"value"in u),x=w({get:()=>c.value?u.value:d.modelValue,set:t=>(t==null?void 0:t.value)&&s(c.value?"change":"update:modelValue",t==null?void 0:t.value)}),z=N(null),k=N("");K(()=>{var t;return(t=z.value)==null?void 0:t.query},t=>{t=t||"",k.value!==t&&(k.value=t,L(t))},{debounce:300,immediate:!0}),K(()=>d.doctype,()=>L(""),{debounce:300,immediate:!0});const _=re({url:"frappe.desk.search.search_link",cache:[d.doctype,k.value,d.hideMe],method:"POST",params:{txt:k.value,doctype:d.doctype},transform:t=>{let f=t.map(y=>({label:__(y.value),value:y.value}));return!d.hideMe&&d.doctype=="User"&&f.unshift({label:"@me",value:"@me"}),f}});function L(t){var f,y,V;(f=_.data)!=null&&f.length&&t===((y=_.params)==null?void 0:y.txt)&&d.doctype===((V=_.params)==null?void 0:V.doctype)||(_.update({params:{txt:t,doctype:d.doctype}}),_.reload())}function C(t){s(c.value?"change":"update:modelValue",""),t()}const O=w(()=>[{sm:"text-xs",md:"text-base"}[u.size||"sm"],"text-gray-600"]);return(t,f)=>{const y=Q("FeatherIcon"),V=Q("Button");return n(),m("div",ve,[r(u).label?(n(),m("label",{key:0,class:A(["block",O.value])},B(t.__(r(u).label)),3)):j("",!0),h(he,{ref_key:"autocomplete",ref:z,options:r(_).data,modelValue:x.value,"onUpdate:modelValue":f[0]||(f[0]=p=>x.value=p),size:r(u).size||"sm",variant:r(u).variant,placeholder:r(u).placeholder,filterable:!1},{target:i(({open:p,togglePopover:e})=>[g(t.$slots,"target",$(S({open:p,togglePopover:e})))]),prefix:i(()=>[g(t.$slots,"prefix")]),"item-prefix":i(({active:p,selected:e,option:a})=>[g(t.$slots,"item-prefix",$(S({active:p,selected:e,option:a})))]),"item-label":i(({active:p,selected:e,option:a})=>[g(t.$slots,"item-label",$(S({active:p,selected:e,option:a})))]),footer:i(({value:p,close:e})=>[r(u).onCreate?(n(),m("div",be,[h(V,{variant:"ghost",class:"w-full !justify-start",label:t.__("Create New"),onClick:a=>r(u).onCreate(p,e)},{prefix:i(()=>[h(y,{name:"plus",class:"h-4"})]),_:2},1032,["label","onClick"])])):j("",!0),b("div",null,[h(V,{variant:"ghost",class:"w-full !justify-start",label:t.__("Clear"),onClick:()=>C(e)},{prefix:i(()=>[h(y,{name:"x",class:"h-4"})]),_:2},1032,["label","onClick"])])]),_:3},8,["options","modelValue","size","variant","placeholder"])])}}};export{xe as _,he as a};
//# sourceMappingURL=Link-88d0f094.js.map
