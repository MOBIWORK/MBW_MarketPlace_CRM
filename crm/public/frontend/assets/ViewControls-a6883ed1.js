import{_ as Ae,e as F,f as X,v as D,m as Oe,u as Ve,r as oe,w as ze,aD as Ht,d as te,l as pe,i as L,h as _,c as Ze,ay as Bn,bn as Yn,bo as Rn,bp as Hn,bq as jn,$ as Un,br as Qt,B as jt,o as Ut,A as he,b3 as fn,x as Me,F as Ke,k as at,bs as ct,j as ee,q as Be,az as zn,n as en,G as $e,Z as Xn,aj as re,a6 as Wn,b2 as Gn,bt as Zn,H as Fe,g as Jn,bu as Kn,y as Qn,aW as eo,a as to,bv as no,bw as oo,D as Vt,bx as ao}from"./index-c24d0e80.js";import{_ as zt,E as hn}from"./EditIcon-2d7044e3.js";import{D as lo}from"./DatePicker-dafc153c.js";import{D as ro}from"./DatetimePicker-dd440c1e.js";import{D as io,d as so}from"./index-4e648177.js";const uo={},co={width:"16",height:"16",fill:"none",viewBox:"0 0 16 16"},fo=D("g",{class:"es-line-reload","clip-path":"url(#a)"},[D("path",{fill:"currentColor","fill-rule":"evenodd",d:"M9.743 2.189a6 6 0 0 0-6.558 2.596.5.5 0 0 0 .844.535 5 5 0 0 1 9.12 1.683l-1.187-.686a.5.5 0 0 0-.5.866l2.165 1.25a.5.5 0 0 0 .683-.183l1.25-2.165a.5.5 0 0 0-.866-.5l-.603 1.044a6 6 0 0 0-4.348-4.44ZM3.356 9.024l1.189.687a.5.5 0 0 0 .5-.866L2.88 7.595a.5.5 0 0 0-.683.183L.947 9.943a.5.5 0 1 0 .866.5l.603-1.044a6 6 0 0 0 10.9 1.816.5.5 0 0 0-.844-.536 5 5 0 0 1-9.116-1.655Z",class:"Union","clip-rule":"evenodd"})],-1),ho=D("defs",null,[D("clipPath",{id:"a",class:"a"},[D("path",{fill:"currentColor",d:"M.25 0h16v16h-16z"})])],-1),po=[fo,ho];function mo(t,e){return F(),X("svg",co,po)}const vo=Ae(uo,[["render",mo]]),go={},_o={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},bo=D("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.72124 1.6001C5.61667 1.6001 4.72124 2.49553 4.72124 3.6001V4.42747H5.72124V3.6001C5.72124 3.04781 6.16895 2.6001 6.72124 2.6001H12.9997C13.552 2.6001 13.9997 3.04781 13.9997 3.6001V8.82643C13.9997 9.37871 13.552 9.82643 12.9997 9.82643H12.1801V10.8264H12.9997C14.1043 10.8264 14.9997 9.931 14.9997 8.82643V3.6001C14.9997 2.49553 14.1043 1.6001 12.9997 1.6001H6.72124ZM3 5.28494C1.89543 5.28494 1 6.18037 1 7.28494V12.5113C1 13.6158 1.89543 14.5113 3 14.5113H9.27846C10.383 14.5113 11.2785 13.6158 11.2785 12.5113V7.28494C11.2785 6.18037 10.383 5.28494 9.27846 5.28494H3ZM2 7.28494C2 6.73266 2.44772 6.28494 3 6.28494H9.27846C9.83075 6.28494 10.2785 6.73266 10.2785 7.28494V12.5113C10.2785 13.0636 9.83075 13.5113 9.27846 13.5113H3C2.44771 13.5113 2 13.0636 2 12.5113V7.28494Z",fill:"currentColor"},null,-1),yo=[bo];function wo(t,e){return F(),X("svg",_o,yo)}const Co=Ae(go,[["render",wo]]),Do={},Eo={width:"15",height:"14",viewBox:"0 0 15 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xo=D("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.1783 0C3.89284 0 2.81689 0.974825 2.69042 2.25405L2.19257 7.2899C2.16724 7.54615 2.07636 7.79156 1.92869 8.00252L0.982801 9.35379C0.518857 10.0166 0.99301 10.9273 1.80203 10.9273H6.53506V13.4998C6.53506 13.776 6.75892 13.9998 7.03506 13.9998C7.31121 13.9998 7.53506 13.776 7.53506 13.4998V10.9273H12.2031C13.0121 10.9273 13.4863 10.0166 13.0223 9.35379L12.0695 7.99254C11.9251 7.78634 11.835 7.54713 11.8074 7.29695L11.2475 2.22567C11.1076 0.958818 10.0371 0 8.76259 0H5.1783ZM3.68557 2.35243C3.76145 1.5849 4.40702 1 5.1783 1H8.76259C9.52732 1 10.1696 1.57529 10.2535 2.3354L10.8134 7.40668C10.8594 7.82365 11.0097 8.22233 11.2502 8.566L12.2031 9.92725H1.80203L2.74793 8.57598C2.99404 8.22439 3.1455 7.81536 3.18772 7.38828L3.68557 2.35243Z",fill:"currentColor"},null,-1),ko=D("rect",{x:"0.792893",width:"2",height:"17",rx:"1",transform:"rotate(-45 0.792893 0)",fill:"currentColor",stroke:"white"},null,-1),So=[xo,ko];function To(t,e){return F(),X("svg",Eo,So)}const Vo=Ae(Do,[["render",To]]),Mo={__name:"ViewModal",props:Oe({doctype:{type:String,required:!0},options:{type:Object,default:{afterCreate:()=>{},afterUpdate:()=>{}}}},{modelValue:{},modelModifiers:{},view:{},viewModifiers:{}}),emits:["update:modelValue","update:view"],setup(t){const e=t,o=Ve(t,"modelValue"),n=Ve(t,"view"),a=oe(!1),l=oe(!1),i=oe({name:"",label:"",filters:{},order_by:"creation desc",columns:"",rows:""});async function r(){var h,p;n.value.doctype=e.doctype;let s=await Ze("crm.fcrm.doctype.crm_view_settings.crm_view_settings.create",{view:n.value});o.value=!1,(p=(h=e.options).afterCreate)==null||p.call(h,s)}async function u(){var s,h;n.value.doctype=e.doctype,await Ze("crm.fcrm.doctype.crm_view_settings.crm_view_settings.update",{view:n.value}),o.value=!1,(h=(s=e.options).afterUpdate)==null||h.call(s,n.value)}return ze(o,s=>{s&&(a.value=!1,l.value=!1,Ht(()=>{i.value={...n.value},i.value.name?a.value=!0:i.value.label&&(l.value=!0)}))}),(s,h)=>{const p=te("FormControl"),d=te("Dialog");return F(),pe(d,{modelValue:o.value,"onUpdate:modelValue":h[1]||(h[1]=E=>o.value=E),options:{title:a.value?s.__("Edit View"):l.value?s.__("Duplicate View"):s.__("Create View"),actions:[{label:a.value?s.__("Save Changes"):l.value?s.__("Duplicate"):s.__("Create"),variant:"solid",onClick:()=>a.value?u():r()}]}},{"body-content":L(()=>[_(p,{variant:"outline",size:"md",type:"text",label:s.__("View Name"),placeholder:s.__("My Open Deals"),modelValue:n.value.label,"onUpdate:modelValue":h[0]||(h[0]=E=>n.value.label=E)},null,8,["label","placeholder","modelValue"])]),_:1},8,["modelValue","options"])}}},Io={},Oo={width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},No=Bn('<path d="M1.75 3.75H10.75" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1.75 7.75H7.75" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1.75 11.75H5.75" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path><path d="M14.25 8.25L12.25 6.25L10.25 8.25" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12.25 12.25L12.25 6.25" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path>',5),Ao=[No];function Po(t,e){return F(),X("svg",Oo,Ao)}const $o=Ae(Io,[["render",Po]]),Fo={},Lo={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},qo=D("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13 6.75C12.3096 6.75 11.75 6.19036 11.75 5.5C11.75 4.80964 12.3096 4.25 13 4.25C13.6904 4.25 14.25 4.80964 14.25 5.5C14.25 6.19036 13.6904 6.75 13 6.75ZM3 6.75C2.30964 6.75 1.75 6.19036 1.75 5.5C1.75 4.80964 2.30964 4.25 3 4.25C3.69036 4.25 4.25 4.80964 4.25 5.5C4.25 6.19036 3.69036 6.75 3 6.75ZM6.75 5.5C6.75 6.19036 7.30964 6.75 8 6.75C8.69036 6.75 9.25 6.19036 9.25 5.5C9.25 4.80964 8.69036 4.25 8 4.25C7.30964 4.25 6.75 4.80964 6.75 5.5ZM13 11.75C12.3096 11.75 11.75 11.1904 11.75 10.5C11.75 9.80964 12.3096 9.25 13 9.25C13.6904 9.25 14.25 9.80964 14.25 10.5C14.25 11.1904 13.6904 11.75 13 11.75ZM1.75 10.5C1.75 11.1904 2.30964 11.75 3 11.75C3.69036 11.75 4.25 11.1904 4.25 10.5C4.25 9.80964 3.69036 9.25 3 9.25C2.30964 9.25 1.75 9.80964 1.75 10.5ZM8 11.75C7.30964 11.75 6.75 11.1904 6.75 10.5C6.75 9.80964 7.30964 9.25 8 9.25C8.69036 9.25 9.25 9.80964 9.25 10.5C9.25 11.1904 8.69036 11.75 8 11.75Z",fill:"currentColor"},null,-1),Bo=[qo];function Yo(t,e){return F(),X("svg",Lo,Bo)}const pn=Ae(Fo,[["render",Yo]]);/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function tn(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),o.push.apply(o,n)}return o}function ke(t){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?tn(Object(o),!0).forEach(function(n){Ro(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):tn(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function gt(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?gt=function(e){return typeof e}:gt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(t)}function Ro(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ne(){return Ne=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},Ne.apply(this,arguments)}function Ho(t,e){if(t==null)return{};var o={},n=Object.keys(t),a,l;for(l=0;l<n.length;l++)a=n[l],!(e.indexOf(a)>=0)&&(o[a]=t[a]);return o}function jo(t,e){if(t==null)return{};var o=Ho(t,e),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var Uo="1.15.2";function Ie(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Pe=Ie(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),dt=Ie(/Edge/i),nn=Ie(/firefox/i),lt=Ie(/safari/i)&&!Ie(/chrome/i)&&!Ie(/android/i),mn=Ie(/iP(ad|od|hone)/i),vn=Ie(/chrome/i)&&Ie(/android/i),gn={capture:!1,passive:!1};function Y(t,e,o){t.addEventListener(e,o,!Pe&&gn)}function q(t,e,o){t.removeEventListener(e,o,!Pe&&gn)}function Ct(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function zo(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function Ee(t,e,o,n){if(t){o=o||document;do{if(e!=null&&(e[0]===">"?t.parentNode===o&&Ct(t,e):Ct(t,e))||n&&t===o)return t;if(t===o)break}while(t=zo(t))}return null}var on=/\s+/g;function ge(t,e,o){if(t&&e)if(t.classList)t.classList[o?"add":"remove"](e);else{var n=(" "+t.className+" ").replace(on," ").replace(" "+e+" "," ");t.className=(n+(o?" "+e:"")).replace(on," ")}}function x(t,e,o){var n=t&&t.style;if(n){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(o=t.currentStyle),e===void 0?o:o[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=o+(typeof o=="string"?"":"px")}}function Qe(t,e){var o="";if(typeof t=="string")o=t;else do{var n=x(t,"transform");n&&n!=="none"&&(o=n+" "+o)}while(!e&&(t=t.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(o)}function _n(t,e,o){if(t){var n=t.getElementsByTagName(e),a=0,l=n.length;if(o)for(;a<l;a++)o(n[a],a);return n}return[]}function xe(){var t=document.scrollingElement;return t||document.documentElement}function Q(t,e,o,n,a){if(!(!t.getBoundingClientRect&&t!==window)){var l,i,r,u,s,h,p;if(t!==window&&t.parentNode&&t!==xe()?(l=t.getBoundingClientRect(),i=l.top,r=l.left,u=l.bottom,s=l.right,h=l.height,p=l.width):(i=0,r=0,u=window.innerHeight,s=window.innerWidth,h=window.innerHeight,p=window.innerWidth),(e||o)&&t!==window&&(a=a||t.parentNode,!Pe))do if(a&&a.getBoundingClientRect&&(x(a,"transform")!=="none"||o&&x(a,"position")!=="static")){var d=a.getBoundingClientRect();i-=d.top+parseInt(x(a,"border-top-width")),r-=d.left+parseInt(x(a,"border-left-width")),u=i+l.height,s=r+l.width;break}while(a=a.parentNode);if(n&&t!==window){var E=Qe(a||t),T=E&&E.a,P=E&&E.d;E&&(i/=P,r/=T,p/=T,h/=P,u=i+h,s=r+p)}return{top:i,left:r,bottom:u,right:s,width:p,height:h}}}function an(t,e,o){for(var n=Ye(t,!0),a=Q(t)[e];n;){var l=Q(n)[o],i=void 0;if(o==="top"||o==="left"?i=a>=l:i=a<=l,!i)return n;if(n===xe())break;n=Ye(n,!1)}return!1}function et(t,e,o,n){for(var a=0,l=0,i=t.children;l<i.length;){if(i[l].style.display!=="none"&&i[l]!==k.ghost&&(n||i[l]!==k.dragged)&&Ee(i[l],o.draggable,t,!1)){if(a===e)return i[l];a++}l++}return null}function Xt(t,e){for(var o=t.lastElementChild;o&&(o===k.ghost||x(o,"display")==="none"||e&&!Ct(o,e));)o=o.previousElementSibling;return o||null}function Ce(t,e){var o=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==k.clone&&(!e||Ct(t,e))&&o++;return o}function ln(t){var e=0,o=0,n=xe();if(t)do{var a=Qe(t),l=a.a,i=a.d;e+=t.scrollLeft*l,o+=t.scrollTop*i}while(t!==n&&(t=t.parentNode));return[e,o]}function Xo(t,e){for(var o in t)if(t.hasOwnProperty(o)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t[o][n])return Number(o)}return-1}function Ye(t,e){if(!t||!t.getBoundingClientRect)return xe();var o=t,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=x(o);if(o.clientWidth<o.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return xe();if(n||e)return o;n=!0}}while(o=o.parentNode);return xe()}function Wo(t,e){if(t&&e)for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}function Mt(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var rt;function bn(t,e){return function(){if(!rt){var o=arguments,n=this;o.length===1?t.call(n,o[0]):t.apply(n,o),rt=setTimeout(function(){rt=void 0},e)}}}function Go(){clearTimeout(rt),rt=void 0}function yn(t,e,o){t.scrollLeft+=e,t.scrollTop+=o}function wn(t){var e=window.Polymer,o=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):o?o(t).clone(!0)[0]:t.cloneNode(!0)}function Cn(t,e,o){var n={};return Array.from(t.children).forEach(function(a){var l,i,r,u;if(!(!Ee(a,e.draggable,t,!1)||a.animated||a===o)){var s=Q(a);n.left=Math.min((l=n.left)!==null&&l!==void 0?l:1/0,s.left),n.top=Math.min((i=n.top)!==null&&i!==void 0?i:1/0,s.top),n.right=Math.max((r=n.right)!==null&&r!==void 0?r:-1/0,s.right),n.bottom=Math.max((u=n.bottom)!==null&&u!==void 0?u:-1/0,s.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var be="Sortable"+new Date().getTime();function Zo(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(a){if(!(x(a,"display")==="none"||a===k.ghost)){t.push({target:a,rect:Q(a)});var l=ke({},t[t.length-1].rect);if(a.thisAnimationDuration){var i=Qe(a,!0);i&&(l.top-=i.f,l.left-=i.e)}a.fromRect=l}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(Xo(t,{target:n}),1)},animateAll:function(n){var a=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var l=!1,i=0;t.forEach(function(r){var u=0,s=r.target,h=s.fromRect,p=Q(s),d=s.prevFromRect,E=s.prevToRect,T=r.rect,P=Qe(s,!0);P&&(p.top-=P.f,p.left-=P.e),s.toRect=p,s.thisAnimationDuration&&Mt(d,p)&&!Mt(h,p)&&(T.top-p.top)/(T.left-p.left)===(h.top-p.top)/(h.left-p.left)&&(u=Ko(T,d,E,a.options)),Mt(p,h)||(s.prevFromRect=h,s.prevToRect=p,u||(u=a.options.animation),a.animate(s,T,p,u)),u&&(l=!0,i=Math.max(i,u),clearTimeout(s.animationResetTimer),s.animationResetTimer=setTimeout(function(){s.animationTime=0,s.prevFromRect=null,s.fromRect=null,s.prevToRect=null,s.thisAnimationDuration=null},u),s.thisAnimationDuration=u)}),clearTimeout(e),l?e=setTimeout(function(){typeof n=="function"&&n()},i):typeof n=="function"&&n(),t=[]},animate:function(n,a,l,i){if(i){x(n,"transition",""),x(n,"transform","");var r=Qe(this.el),u=r&&r.a,s=r&&r.d,h=(a.left-l.left)/(u||1),p=(a.top-l.top)/(s||1);n.animatingX=!!h,n.animatingY=!!p,x(n,"transform","translate3d("+h+"px,"+p+"px,0)"),this.forRepaintDummy=Jo(n),x(n,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),x(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){x(n,"transition",""),x(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},i)}}}}function Jo(t){return t.offsetWidth}function Ko(t,e,o,n){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-o.top,2)+Math.pow(e.left-o.left,2))*n.animation}var Xe=[],It={initializeByDefault:!0},ft={mount:function(e){for(var o in It)It.hasOwnProperty(o)&&!(o in e)&&(e[o]=It[o]);Xe.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Xe.push(e)},pluginEvent:function(e,o,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var l=e+"Global";Xe.forEach(function(i){o[i.pluginName]&&(o[i.pluginName][l]&&o[i.pluginName][l](ke({sortable:o},n)),o.options[i.pluginName]&&o[i.pluginName][e]&&o[i.pluginName][e](ke({sortable:o},n)))})},initializePlugins:function(e,o,n,a){Xe.forEach(function(r){var u=r.pluginName;if(!(!e.options[u]&&!r.initializeByDefault)){var s=new r(e,o,e.options);s.sortable=e,s.options=e.options,e[u]=s,Ne(n,s.defaults)}});for(var l in e.options)if(e.options.hasOwnProperty(l)){var i=this.modifyOption(e,l,e.options[l]);typeof i<"u"&&(e.options[l]=i)}},getEventProperties:function(e,o){var n={};return Xe.forEach(function(a){typeof a.eventProperties=="function"&&Ne(n,a.eventProperties.call(o[a.pluginName],e))}),n},modifyOption:function(e,o,n){var a;return Xe.forEach(function(l){e[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[o]=="function"&&(a=l.optionListeners[o].call(e[l.pluginName],n))}),a}};function Qo(t){var e=t.sortable,o=t.rootEl,n=t.name,a=t.targetEl,l=t.cloneEl,i=t.toEl,r=t.fromEl,u=t.oldIndex,s=t.newIndex,h=t.oldDraggableIndex,p=t.newDraggableIndex,d=t.originalEvent,E=t.putSortable,T=t.extraEventProperties;if(e=e||o&&o[be],!!e){var P,I=e.options,w="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!Pe&&!dt?P=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(P=document.createEvent("Event"),P.initEvent(n,!0,!0)),P.to=i||o,P.from=r||o,P.item=a||o,P.clone=l,P.oldIndex=u,P.newIndex=s,P.oldDraggableIndex=h,P.newDraggableIndex=p,P.originalEvent=d,P.pullMode=E?E.lastPutMode:void 0;var g=ke(ke({},T),ft.getEventProperties(n,e));for(var S in g)P[S]=g[S];o&&o.dispatchEvent(P),I[w]&&I[w].call(e,P)}}var ea=["evt"],fe=function(e,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n.evt,l=jo(n,ea);ft.pluginEvent.bind(k)(e,o,ke({dragEl:v,parentEl:Z,ghostEl:M,rootEl:z,nextEl:Ue,lastDownEl:_t,cloneEl:G,cloneHidden:qe,dragStarted:tt,putSortable:le,activeSortable:k.active,originalEvent:a,oldIndex:Je,oldDraggableIndex:it,newIndex:_e,newDraggableIndex:Le,hideGhostForTarget:kn,unhideGhostForTarget:Sn,cloneNowHidden:function(){qe=!0},cloneNowShown:function(){qe=!1},dispatchSortableEvent:function(r){ce({sortable:o,name:r,originalEvent:a})}},l))};function ce(t){Qo(ke({putSortable:le,cloneEl:G,targetEl:v,rootEl:z,oldIndex:Je,oldDraggableIndex:it,newIndex:_e,newDraggableIndex:Le},t))}var v,Z,M,z,Ue,_t,G,qe,Je,_e,it,Le,ht,le,Ge=!1,Dt=!1,Et=[],He,De,Ot,Nt,rn,sn,tt,We,st,ut=!1,pt=!1,bt,ue,At=[],qt=!1,xt=[],St=typeof document<"u",mt=mn,un=dt||Pe?"cssFloat":"float",ta=St&&!vn&&!mn&&"draggable"in document.createElement("div"),Dn=function(){if(St){if(Pe)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),En=function(e,o){var n=x(e),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),l=et(e,0,o),i=et(e,1,o),r=l&&x(l),u=i&&x(i),s=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+Q(l).width,h=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+Q(i).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&r.float&&r.float!=="none"){var p=r.float==="left"?"left":"right";return i&&(u.clear==="both"||u.clear===p)?"vertical":"horizontal"}return l&&(r.display==="block"||r.display==="flex"||r.display==="table"||r.display==="grid"||s>=a&&n[un]==="none"||i&&n[un]==="none"&&s+h>a)?"vertical":"horizontal"},na=function(e,o,n){var a=n?e.left:e.top,l=n?e.right:e.bottom,i=n?e.width:e.height,r=n?o.left:o.top,u=n?o.right:o.bottom,s=n?o.width:o.height;return a===r||l===u||a+i/2===r+s/2},oa=function(e,o){var n;return Et.some(function(a){var l=a[be].options.emptyInsertThreshold;if(!(!l||Xt(a))){var i=Q(a),r=e>=i.left-l&&e<=i.right+l,u=o>=i.top-l&&o<=i.bottom+l;if(r&&u)return n=a}}),n},xn=function(e){function o(l,i){return function(r,u,s,h){var p=r.options.group.name&&u.options.group.name&&r.options.group.name===u.options.group.name;if(l==null&&(i||p))return!0;if(l==null||l===!1)return!1;if(i&&l==="clone")return l;if(typeof l=="function")return o(l(r,u,s,h),i)(r,u,s,h);var d=(i?r:u).options.group.name;return l===!0||typeof l=="string"&&l===d||l.join&&l.indexOf(d)>-1}}var n={},a=e.group;(!a||gt(a)!="object")&&(a={name:a}),n.name=a.name,n.checkPull=o(a.pull,!0),n.checkPut=o(a.put),n.revertClone=a.revertClone,e.group=n},kn=function(){!Dn&&M&&x(M,"display","none")},Sn=function(){!Dn&&M&&x(M,"display","")};St&&!vn&&document.addEventListener("click",function(t){if(Dt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Dt=!1,!1},!0);var je=function(e){if(v){e=e.touches?e.touches[0]:e;var o=oa(e.clientX,e.clientY);if(o){var n={};for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);n.target=n.rootEl=o,n.preventDefault=void 0,n.stopPropagation=void 0,o[be]._onDragOver(n)}}},aa=function(e){v&&v.parentNode[be]._isOutsideThisEl(e.target)};function k(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=Ne({},e),t[be]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return En(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(i,r){i.setData("Text",r.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:k.supportPointer!==!1&&"PointerEvent"in window&&!lt,emptyInsertThreshold:5};ft.initializePlugins(this,t,o);for(var n in o)!(n in e)&&(e[n]=o[n]);xn(e);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=e.forceFallback?!1:ta,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Y(t,"pointerdown",this._onTapStart):(Y(t,"mousedown",this._onTapStart),Y(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Y(t,"dragover",this),Y(t,"dragenter",this)),Et.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Ne(this,Zo())}k.prototype={constructor:k,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(We=null)},_getDirection:function(e,o){return typeof this.options.direction=="function"?this.options.direction.call(this,e,o,v):this.options.direction},_onTapStart:function(e){if(e.cancelable){var o=this,n=this.el,a=this.options,l=a.preventOnFilter,i=e.type,r=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,u=(r||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||u,h=a.filter;if(fa(n),!v&&!(/mousedown|pointerdown/.test(i)&&e.button!==0||a.disabled)&&!s.isContentEditable&&!(!this.nativeDraggable&&lt&&u&&u.tagName.toUpperCase()==="SELECT")&&(u=Ee(u,a.draggable,n,!1),!(u&&u.animated)&&_t!==u)){if(Je=Ce(u),it=Ce(u,a.draggable),typeof h=="function"){if(h.call(this,e,u,this)){ce({sortable:o,rootEl:s,name:"filter",targetEl:u,toEl:n,fromEl:n}),fe("filter",o,{evt:e}),l&&e.cancelable&&e.preventDefault();return}}else if(h&&(h=h.split(",").some(function(p){if(p=Ee(s,p.trim(),n,!1),p)return ce({sortable:o,rootEl:p,name:"filter",targetEl:u,fromEl:n,toEl:n}),fe("filter",o,{evt:e}),!0}),h)){l&&e.cancelable&&e.preventDefault();return}a.handle&&!Ee(s,a.handle,n,!1)||this._prepareDragStart(e,r,u)}}},_prepareDragStart:function(e,o,n){var a=this,l=a.el,i=a.options,r=l.ownerDocument,u;if(n&&!v&&n.parentNode===l){var s=Q(n);if(z=l,v=n,Z=v.parentNode,Ue=v.nextSibling,_t=n,ht=i.group,k.dragged=v,He={target:v,clientX:(o||e).clientX,clientY:(o||e).clientY},rn=He.clientX-s.left,sn=He.clientY-s.top,this._lastX=(o||e).clientX,this._lastY=(o||e).clientY,v.style["will-change"]="all",u=function(){if(fe("delayEnded",a,{evt:e}),k.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!nn&&a.nativeDraggable&&(v.draggable=!0),a._triggerDragStart(e,o),ce({sortable:a,name:"choose",originalEvent:e}),ge(v,i.chosenClass,!0)},i.ignore.split(",").forEach(function(h){_n(v,h.trim(),Pt)}),Y(r,"dragover",je),Y(r,"mousemove",je),Y(r,"touchmove",je),Y(r,"mouseup",a._onDrop),Y(r,"touchend",a._onDrop),Y(r,"touchcancel",a._onDrop),nn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,v.draggable=!0),fe("delayStart",this,{evt:e}),i.delay&&(!i.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(dt||Pe))){if(k.eventCanceled){this._onDrop();return}Y(r,"mouseup",a._disableDelayedDrag),Y(r,"touchend",a._disableDelayedDrag),Y(r,"touchcancel",a._disableDelayedDrag),Y(r,"mousemove",a._delayedDragTouchMoveHandler),Y(r,"touchmove",a._delayedDragTouchMoveHandler),i.supportPointer&&Y(r,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(u,i.delay)}else u()}},_delayedDragTouchMoveHandler:function(e){var o=e.touches?e.touches[0]:e;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){v&&Pt(v),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;q(e,"mouseup",this._disableDelayedDrag),q(e,"touchend",this._disableDelayedDrag),q(e,"touchcancel",this._disableDelayedDrag),q(e,"mousemove",this._delayedDragTouchMoveHandler),q(e,"touchmove",this._delayedDragTouchMoveHandler),q(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,o){o=o||e.pointerType=="touch"&&e,!this.nativeDraggable||o?this.options.supportPointer?Y(document,"pointermove",this._onTouchMove):o?Y(document,"touchmove",this._onTouchMove):Y(document,"mousemove",this._onTouchMove):(Y(v,"dragend",this),Y(z,"dragstart",this._onDragStart));try{document.selection?yt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,o){if(Ge=!1,z&&v){fe("dragStarted",this,{evt:o}),this.nativeDraggable&&Y(document,"dragover",aa);var n=this.options;!e&&ge(v,n.dragClass,!1),ge(v,n.ghostClass,!0),k.active=this,e&&this._appendGhost(),ce({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(De){this._lastX=De.clientX,this._lastY=De.clientY,kn();for(var e=document.elementFromPoint(De.clientX,De.clientY),o=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(De.clientX,De.clientY),e!==o);)o=e;if(v.parentNode[be]._isOutsideThisEl(e),o)do{if(o[be]){var n=void 0;if(n=o[be]._onDragOver({clientX:De.clientX,clientY:De.clientY,target:e,rootEl:o}),n&&!this.options.dragoverBubble)break}e=o}while(o=o.parentNode);Sn()}},_onTouchMove:function(e){if(He){var o=this.options,n=o.fallbackTolerance,a=o.fallbackOffset,l=e.touches?e.touches[0]:e,i=M&&Qe(M,!0),r=M&&i&&i.a,u=M&&i&&i.d,s=mt&&ue&&ln(ue),h=(l.clientX-He.clientX+a.x)/(r||1)+(s?s[0]-At[0]:0)/(r||1),p=(l.clientY-He.clientY+a.y)/(u||1)+(s?s[1]-At[1]:0)/(u||1);if(!k.active&&!Ge){if(n&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(M){i?(i.e+=h-(Ot||0),i.f+=p-(Nt||0)):i={a:1,b:0,c:0,d:1,e:h,f:p};var d="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");x(M,"webkitTransform",d),x(M,"mozTransform",d),x(M,"msTransform",d),x(M,"transform",d),Ot=h,Nt=p,De=l}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!M){var e=this.options.fallbackOnBody?document.body:z,o=Q(v,!0,mt,!0,e),n=this.options;if(mt){for(ue=e;x(ue,"position")==="static"&&x(ue,"transform")==="none"&&ue!==document;)ue=ue.parentNode;ue!==document.body&&ue!==document.documentElement?(ue===document&&(ue=xe()),o.top+=ue.scrollTop,o.left+=ue.scrollLeft):ue=xe(),At=ln(ue)}M=v.cloneNode(!0),ge(M,n.ghostClass,!1),ge(M,n.fallbackClass,!0),ge(M,n.dragClass,!0),x(M,"transition",""),x(M,"transform",""),x(M,"box-sizing","border-box"),x(M,"margin",0),x(M,"top",o.top),x(M,"left",o.left),x(M,"width",o.width),x(M,"height",o.height),x(M,"opacity","0.8"),x(M,"position",mt?"absolute":"fixed"),x(M,"zIndex","100000"),x(M,"pointerEvents","none"),k.ghost=M,e.appendChild(M),x(M,"transform-origin",rn/parseInt(M.style.width)*100+"% "+sn/parseInt(M.style.height)*100+"%")}},_onDragStart:function(e,o){var n=this,a=e.dataTransfer,l=n.options;if(fe("dragStart",this,{evt:e}),k.eventCanceled){this._onDrop();return}fe("setupClone",this),k.eventCanceled||(G=wn(v),G.removeAttribute("id"),G.draggable=!1,G.style["will-change"]="",this._hideClone(),ge(G,this.options.chosenClass,!1),k.clone=G),n.cloneId=yt(function(){fe("clone",n),!k.eventCanceled&&(n.options.removeCloneOnHide||z.insertBefore(G,v),n._hideClone(),ce({sortable:n,name:"clone"}))}),!o&&ge(v,l.dragClass,!0),o?(Dt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(q(document,"mouseup",n._onDrop),q(document,"touchend",n._onDrop),q(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",l.setData&&l.setData.call(n,a,v)),Y(document,"drop",n),x(v,"transform","translateZ(0)")),Ge=!0,n._dragStartId=yt(n._dragStarted.bind(n,o,e)),Y(document,"selectstart",n),tt=!0,lt&&x(document.body,"user-select","none")},_onDragOver:function(e){var o=this.el,n=e.target,a,l,i,r=this.options,u=r.group,s=k.active,h=ht===u,p=r.sort,d=le||s,E,T=this,P=!1;if(qt)return;function I(V,N){fe(V,T,ke({evt:e,isOwner:h,axis:E?"vertical":"horizontal",revert:i,dragRect:a,targetRect:l,canSort:p,fromSortable:d,target:n,completed:g,onMove:function(H,U){return vt(z,o,v,a,H,Q(H),e,U)},changed:S},N))}function w(){I("dragOverAnimationCapture"),T.captureAnimationState(),T!==d&&d.captureAnimationState()}function g(V){return I("dragOverCompleted",{insertion:V}),V&&(h?s._hideClone():s._showClone(T),T!==d&&(ge(v,le?le.options.ghostClass:s.options.ghostClass,!1),ge(v,r.ghostClass,!0)),le!==T&&T!==k.active?le=T:T===k.active&&le&&(le=null),d===T&&(T._ignoreWhileAnimating=n),T.animateAll(function(){I("dragOverAnimationComplete"),T._ignoreWhileAnimating=null}),T!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(n===v&&!v.animated||n===o&&!n.animated)&&(We=null),!r.dragoverBubble&&!e.rootEl&&n!==document&&(v.parentNode[be]._isOutsideThisEl(e.target),!V&&je(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),P=!0}function S(){_e=Ce(v),Le=Ce(v,r.draggable),ce({sortable:T,name:"change",toEl:o,newIndex:_e,newDraggableIndex:Le,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=Ee(n,r.draggable,o,!0),I("dragOver"),k.eventCanceled)return P;if(v.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||T._ignoreWhileAnimating===n)return g(!1);if(Dt=!1,s&&!r.disabled&&(h?p||(i=Z!==z):le===this||(this.lastPutMode=ht.checkPull(this,s,v,e))&&u.checkPut(this,s,v,e))){if(E=this._getDirection(e,n)==="vertical",a=Q(v),I("dragOverValid"),k.eventCanceled)return P;if(i)return Z=z,w(),this._hideClone(),I("revert"),k.eventCanceled||(Ue?z.insertBefore(v,Ue):z.appendChild(v)),g(!0);var m=Xt(o,r.draggable);if(!m||sa(e,E,this)&&!m.animated){if(m===v)return g(!1);if(m&&o===e.target&&(n=m),n&&(l=Q(n)),vt(z,o,v,a,n,l,e,!!n)!==!1)return w(),m&&m.nextSibling?o.insertBefore(v,m.nextSibling):o.appendChild(v),Z=o,S(),g(!0)}else if(m&&ia(e,E,this)){var C=et(o,0,r,!0);if(C===v)return g(!1);if(n=C,l=Q(n),vt(z,o,v,a,n,l,e,!1)!==!1)return w(),o.insertBefore(v,C),Z=o,S(),g(!0)}else if(n.parentNode===o){l=Q(n);var O=0,b,ae=v.parentNode!==o,B=!na(v.animated&&v.toRect||a,n.animated&&n.toRect||l,E),$=E?"top":"left",R=an(n,"top","top")||an(v,"top","top"),me=R?R.scrollTop:void 0;We!==n&&(b=l[$],ut=!1,pt=!B&&r.invertSwap||ae),O=ua(e,n,l,E,B?1:r.swapThreshold,r.invertedSwapThreshold==null?r.swapThreshold:r.invertedSwapThreshold,pt,We===n);var ie;if(O!==0){var de=Ce(v);do de-=O,ie=Z.children[de];while(ie&&(x(ie,"display")==="none"||ie===M))}if(O===0||ie===n)return g(!1);We=n,st=O;var ye=n.nextElementSibling,we=!1;we=O===1;var f=vt(z,o,v,a,n,l,e,we);if(f!==!1)return(f===1||f===-1)&&(we=f===1),qt=!0,setTimeout(ra,30),w(),we&&!ye?o.appendChild(v):n.parentNode.insertBefore(v,we?ye:n),R&&yn(R,0,me-R.scrollTop),Z=v.parentNode,b!==void 0&&!pt&&(bt=Math.abs(b-Q(n)[$])),S(),g(!0)}if(o.contains(v))return g(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){q(document,"mousemove",this._onTouchMove),q(document,"touchmove",this._onTouchMove),q(document,"pointermove",this._onTouchMove),q(document,"dragover",je),q(document,"mousemove",je),q(document,"touchmove",je)},_offUpEvents:function(){var e=this.el.ownerDocument;q(e,"mouseup",this._onDrop),q(e,"touchend",this._onDrop),q(e,"pointerup",this._onDrop),q(e,"touchcancel",this._onDrop),q(document,"selectstart",this)},_onDrop:function(e){var o=this.el,n=this.options;if(_e=Ce(v),Le=Ce(v,n.draggable),fe("drop",this,{evt:e}),Z=v&&v.parentNode,_e=Ce(v),Le=Ce(v,n.draggable),k.eventCanceled){this._nulling();return}Ge=!1,pt=!1,ut=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Bt(this.cloneId),Bt(this._dragStartId),this.nativeDraggable&&(q(document,"drop",this),q(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),lt&&x(document.body,"user-select",""),x(v,"transform",""),e&&(tt&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),M&&M.parentNode&&M.parentNode.removeChild(M),(z===Z||le&&le.lastPutMode!=="clone")&&G&&G.parentNode&&G.parentNode.removeChild(G),v&&(this.nativeDraggable&&q(v,"dragend",this),Pt(v),v.style["will-change"]="",tt&&!Ge&&ge(v,le?le.options.ghostClass:this.options.ghostClass,!1),ge(v,this.options.chosenClass,!1),ce({sortable:this,name:"unchoose",toEl:Z,newIndex:null,newDraggableIndex:null,originalEvent:e}),z!==Z?(_e>=0&&(ce({rootEl:Z,name:"add",toEl:Z,fromEl:z,originalEvent:e}),ce({sortable:this,name:"remove",toEl:Z,originalEvent:e}),ce({rootEl:Z,name:"sort",toEl:Z,fromEl:z,originalEvent:e}),ce({sortable:this,name:"sort",toEl:Z,originalEvent:e})),le&&le.save()):_e!==Je&&_e>=0&&(ce({sortable:this,name:"update",toEl:Z,originalEvent:e}),ce({sortable:this,name:"sort",toEl:Z,originalEvent:e})),k.active&&((_e==null||_e===-1)&&(_e=Je,Le=it),ce({sortable:this,name:"end",toEl:Z,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){fe("nulling",this),z=v=Z=M=Ue=G=_t=qe=He=De=tt=_e=Le=Je=it=We=st=le=ht=k.dragged=k.ghost=k.clone=k.active=null,xt.forEach(function(e){e.checked=!0}),xt.length=Ot=Nt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":v&&(this._onDragOver(e),la(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],o,n=this.el.children,a=0,l=n.length,i=this.options;a<l;a++)o=n[a],Ee(o,i.draggable,this.el,!1)&&e.push(o.getAttribute(i.dataIdAttr)||da(o));return e},sort:function(e,o){var n={},a=this.el;this.toArray().forEach(function(l,i){var r=a.children[i];Ee(r,this.options.draggable,a,!1)&&(n[l]=r)},this),o&&this.captureAnimationState(),e.forEach(function(l){n[l]&&(a.removeChild(n[l]),a.appendChild(n[l]))}),o&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,o){return Ee(e,o||this.options.draggable,this.el,!1)},option:function(e,o){var n=this.options;if(o===void 0)return n[e];var a=ft.modifyOption(this,e,o);typeof a<"u"?n[e]=a:n[e]=o,e==="group"&&xn(n)},destroy:function(){fe("destroy",this);var e=this.el;e[be]=null,q(e,"mousedown",this._onTapStart),q(e,"touchstart",this._onTapStart),q(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(q(e,"dragover",this),q(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Et.splice(Et.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!qe){if(fe("hideClone",this),k.eventCanceled)return;x(G,"display","none"),this.options.removeCloneOnHide&&G.parentNode&&G.parentNode.removeChild(G),qe=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(qe){if(fe("showClone",this),k.eventCanceled)return;v.parentNode==z&&!this.options.group.revertClone?z.insertBefore(G,v):Ue?z.insertBefore(G,Ue):z.appendChild(G),this.options.group.revertClone&&this.animate(v,G),x(G,"display",""),qe=!1}}};function la(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function vt(t,e,o,n,a,l,i,r){var u,s=t[be],h=s.options.onMove,p;return window.CustomEvent&&!Pe&&!dt?u=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(u=document.createEvent("Event"),u.initEvent("move",!0,!0)),u.to=e,u.from=t,u.dragged=o,u.draggedRect=n,u.related=a||e,u.relatedRect=l||Q(e),u.willInsertAfter=r,u.originalEvent=i,t.dispatchEvent(u),h&&(p=h.call(s,u,i)),p}function Pt(t){t.draggable=!1}function ra(){qt=!1}function ia(t,e,o){var n=Q(et(o.el,0,o.options,!0)),a=Cn(o.el,o.options,M),l=10;return e?t.clientX<a.left-l||t.clientY<n.top&&t.clientX<n.right:t.clientY<a.top-l||t.clientY<n.bottom&&t.clientX<n.left}function sa(t,e,o){var n=Q(Xt(o.el,o.options.draggable)),a=Cn(o.el,o.options,M),l=10;return e?t.clientX>a.right+l||t.clientY>n.bottom&&t.clientX>n.left:t.clientY>a.bottom+l||t.clientX>n.right&&t.clientY>n.top}function ua(t,e,o,n,a,l,i,r){var u=n?t.clientY:t.clientX,s=n?o.height:o.width,h=n?o.top:o.left,p=n?o.bottom:o.right,d=!1;if(!i){if(r&&bt<s*a){if(!ut&&(st===1?u>h+s*l/2:u<p-s*l/2)&&(ut=!0),ut)d=!0;else if(st===1?u<h+bt:u>p-bt)return-st}else if(u>h+s*(1-a)/2&&u<p-s*(1-a)/2)return ca(e)}return d=d||i,d&&(u<h+s*l/2||u>p-s*l/2)?u>h+s/2?1:-1:0}function ca(t){return Ce(v)<Ce(t)?1:-1}function da(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,o=e.length,n=0;o--;)n+=e.charCodeAt(o);return n.toString(36)}function fa(t){xt.length=0;for(var e=t.getElementsByTagName("input"),o=e.length;o--;){var n=e[o];n.checked&&xt.push(n)}}function yt(t){return setTimeout(t,0)}function Bt(t){return clearTimeout(t)}St&&Y(document,"touchmove",function(t){(k.active||Ge)&&t.cancelable&&t.preventDefault()});k.utils={on:Y,off:q,css:x,find:_n,is:function(e,o){return!!Ee(e,o,e,!1)},extend:Wo,throttle:bn,closest:Ee,toggleClass:ge,clone:wn,index:Ce,nextTick:yt,cancelNextTick:Bt,detectDirection:En,getChild:et};k.get=function(t){return t[be]};k.mount=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(k.utils=ke(ke({},k.utils),n.utils)),ft.mount(n)})};k.create=function(t,e){return new k(t,e)};k.version=Uo;var K=[],nt,Yt,Rt=!1,$t,Ft,kt,ot;function ha(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(o){var n=o.originalEvent;this.sortable.nativeDraggable?Y(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Y(document,"pointermove",this._handleFallbackAutoScroll):n.touches?Y(document,"touchmove",this._handleFallbackAutoScroll):Y(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var n=o.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?q(document,"dragover",this._handleAutoScroll):(q(document,"pointermove",this._handleFallbackAutoScroll),q(document,"touchmove",this._handleFallbackAutoScroll),q(document,"mousemove",this._handleFallbackAutoScroll)),cn(),wt(),Go()},nulling:function(){kt=Yt=nt=Rt=ot=$t=Ft=null,K.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,n){var a=this,l=(o.touches?o.touches[0]:o).clientX,i=(o.touches?o.touches[0]:o).clientY,r=document.elementFromPoint(l,i);if(kt=o,n||this.options.forceAutoScrollFallback||dt||Pe||lt){Lt(o,this.options,r,n);var u=Ye(r,!0);Rt&&(!ot||l!==$t||i!==Ft)&&(ot&&cn(),ot=setInterval(function(){var s=Ye(document.elementFromPoint(l,i),!0);s!==u&&(u=s,wt()),Lt(o,a.options,s,n)},10),$t=l,Ft=i)}else{if(!this.options.bubbleScroll||Ye(r,!0)===xe()){wt();return}Lt(o,this.options,Ye(r,!1),!1)}}},Ne(t,{pluginName:"scroll",initializeByDefault:!0})}function wt(){K.forEach(function(t){clearInterval(t.pid)}),K=[]}function cn(){clearInterval(ot)}var Lt=bn(function(t,e,o,n){if(e.scroll){var a=(t.touches?t.touches[0]:t).clientX,l=(t.touches?t.touches[0]:t).clientY,i=e.scrollSensitivity,r=e.scrollSpeed,u=xe(),s=!1,h;Yt!==o&&(Yt=o,wt(),nt=e.scroll,h=e.scrollFn,nt===!0&&(nt=Ye(o,!0)));var p=0,d=nt;do{var E=d,T=Q(E),P=T.top,I=T.bottom,w=T.left,g=T.right,S=T.width,m=T.height,C=void 0,O=void 0,b=E.scrollWidth,ae=E.scrollHeight,B=x(E),$=E.scrollLeft,R=E.scrollTop;E===u?(C=S<b&&(B.overflowX==="auto"||B.overflowX==="scroll"||B.overflowX==="visible"),O=m<ae&&(B.overflowY==="auto"||B.overflowY==="scroll"||B.overflowY==="visible")):(C=S<b&&(B.overflowX==="auto"||B.overflowX==="scroll"),O=m<ae&&(B.overflowY==="auto"||B.overflowY==="scroll"));var me=C&&(Math.abs(g-a)<=i&&$+S<b)-(Math.abs(w-a)<=i&&!!$),ie=O&&(Math.abs(I-l)<=i&&R+m<ae)-(Math.abs(P-l)<=i&&!!R);if(!K[p])for(var de=0;de<=p;de++)K[de]||(K[de]={});(K[p].vx!=me||K[p].vy!=ie||K[p].el!==E)&&(K[p].el=E,K[p].vx=me,K[p].vy=ie,clearInterval(K[p].pid),(me!=0||ie!=0)&&(s=!0,K[p].pid=setInterval((function(){n&&this.layer===0&&k.active._onTouchMove(kt);var ye=K[this.layer].vy?K[this.layer].vy*r:0,we=K[this.layer].vx?K[this.layer].vx*r:0;typeof h=="function"&&h.call(k.dragged.parentNode[be],we,ye,t,kt,K[this.layer].el)!=="continue"||yn(K[this.layer].el,we,ye)}).bind({layer:p}),24))),p++}while(e.bubbleScroll&&d!==u&&(d=Ye(d,!1)));Rt=s}},30),Tn=function(e){var o=e.originalEvent,n=e.putSortable,a=e.dragEl,l=e.activeSortable,i=e.dispatchSortableEvent,r=e.hideGhostForTarget,u=e.unhideGhostForTarget;if(o){var s=n||l;r();var h=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,p=document.elementFromPoint(h.clientX,h.clientY);u(),s&&!s.el.contains(p)&&(i("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function Wt(){}Wt.prototype={startIndex:null,dragStart:function(e){var o=e.oldDraggableIndex;this.startIndex=o},onSpill:function(e){var o=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=et(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(o,a):this.sortable.el.appendChild(o),this.sortable.animateAll(),n&&n.animateAll()},drop:Tn};Ne(Wt,{pluginName:"revertOnSpill"});function Gt(){}Gt.prototype={onSpill:function(e){var o=e.dragEl,n=e.putSortable,a=n||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:Tn};Ne(Gt,{pluginName:"removeOnSpill"});k.mount(new ha);k.mount(Gt,Wt);function pa(t,e,o={}){let n;const{document:a=jn,...l}=o,i={onUpdate:h=>{ma(e,h.oldIndex,h.newIndex)}},r=()=>{const h=typeof t=="string"?a==null?void 0:a.querySelector(t):Hn(t);!h||n!==void 0||(n=new k(h,{...i,...l}))},u=()=>{n==null||n.destroy(),n=void 0},s=(h,p)=>{if(p!==void 0)n==null||n.option(h,p);else return n==null?void 0:n.option(h)};return Yn(r),Rn(u),{stop:u,start:r,option:s}}function ma(t,e,o){const n=Un(t),a=n?[...Qt(t)]:Qt(t);if(o>=0&&o<a.length){const l=a.splice(e,1)[0];Ht(()=>{a.splice(o,0,l),n&&(t.value=a)})}}const va={class:"flex h-5 w-5 items-center justify-center rounded bg-gray-900 pt-[1px] text-2xs font-medium text-white"},ga={class:"my-2 rounded-lg border border-gray-100 bg-white shadow-xl"},_a={class:"min-w-[352px] p-2"},ba={key:0,id:"sort-list",class:"mb-3 flex flex-col gap-2"},ya={class:"handle flex h-7 w-7 items-center justify-center"},wa={key:1,class:"mb-3 flex h-7 items-center px-3 text-sm text-gray-600"},Ca={class:"flex items-center justify-between gap-2"},Da={__name:"SortBy",props:Oe({doctype:{type:String,required:!0}},{modelValue:{},modelModifiers:{}}),emits:Oe(["update"],["update:modelValue"]),setup(t,{emit:e}){const o=t,n=e,a=Ve(t,"modelValue"),l=oe(null),i=jt({url:"crm.api.doc.sort_options",cache:["sortOptions",o.doctype],params:{doctype:o.doctype}});Ut(()=>{var w;(w=i.data)!=null&&w.length||i.fetch()});const r=he({get:()=>{var g,S,m;if(!((g=a.value)!=null&&g.data))return new Set;let w=(m=(S=a.value)==null?void 0:S.params)==null?void 0:m.order_by;return!w||!i.data?new Set:w.trim()==="creation desc"?new Set:(w=w.split(", ").map(C=>{const[O,b]=C.split(" ");return{fieldname:O,direction:b}}),new Set(w))},set:w=>{a.value.params.order_by=P(w)}}),u=he(()=>{if(!i.data)return[];if(!r.value.size)return i.data;const w=[...r.value].map(g=>g.fieldname);return I(),i.data.filter(g=>!w.includes(g.value))}),s=pa("#sort-list",r,{handle:".handle",animation:200,onEnd:()=>T()});function h(w){r.value.add({fieldname:w.value,direction:"asc"}),I(),T()}function p(w,g){let S=Array.from(r.value)[g];r.value.delete(S),r.value.add({fieldname:w.value,direction:S.direction}),T()}function d(w){r.value.delete(Array.from(r.value)[w]),T()}function E(w){r.value.clear(),T(),w()}function T(){Ht(()=>{n("update",P(r.value))})}function P(w){let g="";return w.forEach(S=>{g+=`${S.fieldname} ${S.direction}, `}),g=g.slice(0,-2),g}function I(){s.stop(),s.start()}return(w,g)=>{const S=te("Button"),m=te("FormControl"),C=te("FeatherIcon");return F(),pe(zt,null,{target:L(()=>{var O;return[_(S,{label:w.__("Sort"),ref_key:"sortButtonRef",ref:l},fn({prefix:L(()=>[_($o,{class:"h-4"})]),_:2},[(O=r.value)!=null&&O.size?{name:"suffix",fn:L(()=>[D("div",va,Me(r.value.size),1)]),key:"0"}:void 0]),1032,["label"])]}),body:L(({close:O})=>{var b,ae;return[D("div",ga,[D("div",_a,[(b=r.value)!=null&&b.size?(F(),X("div",ba,[(F(!0),X(Ke,null,at(r.value,(B,$)=>(F(),X("div",{key:B.fieldname,class:"flex items-center gap-2"},[D("div",ya,[_(pn,{class:"h-4 w-4 cursor-grab text-gray-600"})]),_(ct,{class:"!w-32",value:B.fieldname,options:ee(i).data,onChange:R=>p(R,$),placeholder:w.__("First Name")},null,8,["value","options","onChange","placeholder"]),_(m,{class:"!w-32",type:"select",modelValue:B.direction,"onUpdate:modelValue":R=>B.direction=R,options:[{label:w.__("Ascending"),value:"asc"},{label:w.__("Descending"),value:"desc"}],onChange:R=>{B.direction=R.target.value,T()},placeholder:w.__("Ascending")},null,8,["modelValue","onUpdate:modelValue","options","onChange","placeholder"]),_(S,{variant:"ghost",icon:"x",onClick:R=>d($)},null,8,["onClick"])]))),128))])):(F(),X("div",wa,Me(w.__("Empty - Choose a field to sort by")),1)),D("div",Ca,[_(ct,{options:u.value,value:"",placeholder:w.__("First Name"),onChange:g[0]||(g[0]=B=>h(B))},{target:L(({togglePopover:B})=>[_(S,{class:"!text-gray-600",variant:"ghost",onClick:$=>B(),label:w.__("Add Sort")},{prefix:L(()=>[_(C,{name:"plus",class:"h-4"})]),_:2},1032,["onClick","label"])]),_:1},8,["options","placeholder"]),(ae=r.value)!=null&&ae.size?(F(),pe(S,{key:0,class:"!text-gray-600",variant:"ghost",label:w.__("Clear Sort"),onClick:B=>E(O)},null,8,["label","onClick"])):Be("",!0)])])])]}),_:1})}}},Ea={name:"DateRangePicker",props:["value","placeholder","formatter","readonly","inputClass"],emits:["change"],components:{Popover:zn},data(){const t=this.value?this.value[0]:"",e=this.value?this.value[1]:"";return{currentYear:null,currentMonth:null,fromDate:t,toDate:e}},created(){this.selectCurrentMonthYear()},computed:{today(){return this.getDate()},datesAsWeeks(){let t=[],e=this.dates.slice();for(;e.length;){let o=e.splice(0,7);t.push(o)}return t},dates(){if(!(this.currentYear&&this.currentMonth))return[];let t=this.currentMonth-1,e=this.currentYear,o=this.getDate(e,t,1),n=this.getDate(e,t+1,0),a=o.getDay(),l=6-n.getDay(),i=this.getDatesAfter(o,-a),r=this.getDatesAfter(n,l),u=this.getDaysInMonth(t,e),s=this.getDatesAfter(o,u-1),h=[...i,o,...s,...r];if(h.length<42){const p=this.getDatesAfter(h.at(-1),42-h.length);h=h.concat(...p)}return h},formatMonth(){let t=this.getDate(this.currentYear,this.currentMonth-1,1);return`${__(t.toLocaleString("en-US",{month:"long"}))}, ${t.getFullYear()}`}},methods:{handleDateClick(t){this.fromDate&&this.toDate?(this.fromDate=this.toValue(t),this.toDate=""):this.fromDate&&!this.toDate?this.toDate=this.toValue(t):this.fromDate=this.toValue(t),this.swapDatesIfNecessary()},selectDates(){if(!this.fromDate&&!this.toDate)return this.$emit("change","");this.$emit("change",`${this.fromDate},${this.toDate}`)},swapDatesIfNecessary(){if(!this.fromDate||!this.toDate)return;let t=this.getDate(this.fromDate),e=this.getDate(this.toDate);if(t>e){let o=t;t=e,e=o}this.fromDate=this.toValue(t),this.toDate=this.toValue(e)},selectCurrentMonthYear(){let t=this.toDate?this.getDate(this.toDate):this.today;this.currentYear=t.getFullYear(),this.currentMonth=t.getMonth()+1},prevMonth(){this.changeMonth(-1)},nextMonth(){this.changeMonth(1)},changeMonth(t){this.currentMonth=this.currentMonth+t,this.currentMonth<1&&(this.currentMonth=12,this.currentYear=this.currentYear-1),this.currentMonth>12&&(this.currentMonth=1,this.currentYear=this.currentYear+1)},getDatesAfter(t,e){let o=1;e<0&&(o=-1,e=Math.abs(e));let n=[];for(;e;)t=this.getDate(t.getFullYear(),t.getMonth(),t.getDate()+o),n.push(t),e--;return o===-1?n.reverse():n},getDaysInMonth(t,e){let n=[31,28,31,30,31,30,31,31,30,31,30,31][t];return t===1&&this.isLeapYear(e)?29:n},isLeapYear(t){return t%400===0?!0:t%100===0?!1:t%4===0},toValue(t){return t?typeof t=="string"?t:(t.setHours(0,-t.getTimezoneOffset(),0,0),t.toISOString().slice(0,10)):""},getDate(...t){return new Date(...t)},isInRange(t){return!this.fromDate||!this.toDate?!1:t>=this.getDate(this.fromDate)&&t<=this.getDate(this.toDate)},formatDates(t){if(!t)return"";const e=t.split(",");return this.formatter(e[0])+" to "+this.formatter(e[1])},clearDates(){this.fromDate="",this.toDate="",this.selectDates()}}},xa=["placeholder","value","onFocus"],ka={class:"mt-2 w-fit select-none divide-y rounded-lg bg-white text-base shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},Sa={class:"flex items-center p-1 text-gray-500"},Ta={class:"flex-1 text-center text-base font-medium text-gray-700"},Va={class:"flex items-center justify-center gap-1 p-1"},Ma={class:"flex flex-col items-center justify-center p-1 text-gray-800"},Ia={class:"flex items-center text-xs uppercase"},Oa=["onClick"],Na={class:"flex justify-end space-x-1 p-1"};function Aa(t,e,o,n,a,l){const i=te("FeatherIcon"),r=te("Button"),u=te("TextInput"),s=te("Popover");return F(),pe(s,{onOpen:l.selectCurrentMonthYear,class:"flex w-full [&>div:first-child]:w-full"},{target:L(({togglePopover:h})=>[D("input",{readonly:"",type:"text",placeholder:o.placeholder,value:o.formatter?l.formatDates(o.value):o.value,onFocus:p=>o.readonly?null:h(),class:en(["form-input block h-7 w-full cursor-pointer select-none rounded border-gray-400 text-sm  placeholder-gray-500 ",o.inputClass])},null,42,xa)]),body:L(({togglePopover:h})=>[D("div",ka,[D("div",Sa,[_(r,{variant:"ghost",class:"h-7 w-7",onClick:l.prevMonth},{default:L(()=>[_(i,{"stroke-width":"2",name:"chevron-left",class:"h-4 w-4"})]),_:1},8,["onClick"]),D("div",Ta,Me(l.formatMonth),1),_(r,{variant:"ghost",class:"h-7 w-7",onClick:l.nextMonth},{default:L(()=>[_(i,{"stroke-width":"2",name:"chevron-right",class:"h-4 w-4"})]),_:1},8,["onClick"])]),D("div",Va,[_(u,{class:"w-28 text-sm",type:"text",modelValue:a.fromDate,"onUpdate:modelValue":e[0]||(e[0]=p=>a.fromDate=p)},null,8,["modelValue"]),_(u,{class:"w-28 text-sm",type:"text",modelValue:a.toDate,"onUpdate:modelValue":e[1]||(e[1]=p=>a.toDate=p)},null,8,["modelValue"])]),D("div",Ma,[D("div",Ia,[(F(),X(Ke,null,at(["su","mo","tu","we","th","fr","sa"],(p,d)=>D("div",{class:"flex h-6 w-8 items-center justify-center text-center",key:d},Me(t.__(p)),1)),64))]),(F(!0),X(Ke,null,at(l.datesAsWeeks,(p,d)=>(F(),X("div",{class:"flex items-center",key:d},[(F(!0),X(Ke,null,at(p,E=>(F(),X("div",{key:l.toValue(E),class:en(["flex h-8 w-8 cursor-pointer items-center justify-center rounded hover:bg-gray-50",{"text-gray-400":E.getMonth()!==a.currentMonth-1,"text-gray-900":E.getMonth()===a.currentMonth-1,"font-extrabold text-gray-900":l.toValue(E)===l.toValue(l.today),"rounded-none bg-gray-100":l.isInRange(E),"rounded-l-md rounded-r-none bg-gray-800 text-white hover:bg-gray-800":a.fromDate&&l.toValue(E)===l.toValue(a.fromDate),"rounded-r-md bg-gray-800 text-white hover:bg-gray-800":a.toDate&&l.toValue(E)===l.toValue(a.toDate)}]),onClick:()=>l.handleDateClick(E)},Me(E.getDate()),11,Oa))),128))]))),128))]),D("div",Na,[_(r,{label:t.__("Clear"),onClick:()=>l.clearDates()|h(),disabled:!a.fromDate||!a.toDate},null,8,["label","onClick","disabled"]),_(r,{variant:"solid",label:t.__("Apply"),disabled:!a.fromDate||!a.toDate,onClick:()=>l.selectDates()|h()},null,8,["label","disabled","onClick"])])])]),_:1},8,["onOpen"])}const Pa=Ae(Ea,[["render",Aa]]),$a={},Fa={width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},La=D("path",{d:"M2 4.5H14",stroke:"currentColor","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),qa=D("path",{d:"M4 8.5H12",stroke:"currentColor","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Ba=D("path",{d:"M6.5 12.5H9.5",stroke:"currentColor","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Ya=[La,qa,Ba];function Ra(t,e){return F(),X("svg",Fa,Ya)}const Ha=Ae($a,[["render",Ra]]),ja={class:"flex h-5 w-5 items-center justify-center rounded bg-gray-900 pt-[1px] text-2xs font-medium text-white"},Ua={class:"my-2 rounded-lg border border-gray-100 bg-white shadow-xl"},za={class:"min-w-[400px] p-2"},Xa={class:"flex items-center gap-2"},Wa={class:"w-13 pl-2 text-end text-base text-gray-600"},Ga={id:"fieldname",class:"!min-w-[140px]"},Za={id:"operator"},Ja={id:"value",class:"!min-w-[140px]"},Ka={key:1,class:"mb-3 flex h-7 items-center px-3 text-sm text-gray-600"},Qa={class:"flex items-center justify-between gap-2"},el={__name:"Filter",props:Oe({doctype:{type:String,required:!0},default_filters:{type:Object,default:{}}},{modelValue:{},modelModifiers:{}}),emits:Oe(["update"],["update:modelValue"]),setup(t,{emit:e}){const o=["Check"],n=["Link","Dynamic Link"],a=["Float","Int","Currency","Percent"],l=["Select"],i=["Data","Long Text","Small Text","Text Editor","Text"],r=["Date","Datetime"],u=t,s=e,h=Ve(t,"modelValue"),p=jt({url:"crm.api.doc.get_filterable_fields",cache:["filterableFields",u.doctype],params:{doctype:u.doctype},transform(f){return f=f.map(V=>({label:V.label,value:V.fieldname,...V})),f}});Ut(()=>{var f;(f=p.data)!=null&&f.length||p.fetch()});const d=he(()=>{var V,N,j,H,U;if(!((V=h.value)!=null&&V.data))return new Set;let f=((j=(N=h.value)==null?void 0:N.params)==null?void 0:j.filters)||((U=(H=h.value.data)==null?void 0:H.params)==null?void 0:U.filters);return!f||!p.data?new Set:(u.default_filters&&(f=E(u.default_filters,f)),T(p.data,f))});function E(f,V){for(const N in f)f.hasOwnProperty(N)&&V.hasOwnProperty(N)&&f[N]===V[N]&&delete V[N];return V}function T(f,V){let N=[];for(let[j,H]of Object.entries(V)){let U=f.find(Se=>Se.fieldname===j);typeof H!="object"&&(H=["=",H],U.fieldtype==="Check"&&(H=["equals",H[1]?"Yes":"No"])),U&&N.push({field:U,fieldname:j,operator:ye[H[0]],value:H[1]})}return new Set(N)}function P(f,V){let N=[];return i.includes(f)&&N.push({label:__("Equals"),value:"equals"},{label:__("Not Equals"),value:"not equals"},{label:__("Like"),value:"like"},{label:__("Not Like"),value:"not like"}),V==="_assign"&&(N=[{label:__("Like"),value:"like"},{label:__("Not Like"),value:"not like"}]),a.includes(f)&&N.push({label:__("Equals"),value:"equals"},{label:__("Not Equals"),value:"not equals"},{label:__("Like"),value:"like"},{label:__("Not Like"),value:"not like"},{label:__("<"),value:"<"},{label:__(">"),value:">"},{label:__("<="),value:"<="},{label:__(">="),value:">="}),l.includes(f)&&N.push({label:__("Equals"),value:"equals"},{label:__("Not Equals"),value:"not equals"}),n.includes(f)&&N.push({label:__("Equals"),value:"equals"},{label:__("Not Equals"),value:"not equals"},{label:__("Like"),value:"like"},{label:__("Not Like"),value:"not like"}),o.includes(f)&&N.push({label:__("Equals"),value:"equals"}),["Duration"].includes(f)&&N.push({label:__("Like"),value:"like"},{label:__("Not Like"),value:"not like"}),r.includes(f)&&N.push({label:__(">"),value:">"},{label:__("<"),value:"<"},{label:__(">="),value:">="},{label:__("<="),value:"<="},{label:__("Between"),value:"between"}),N}function I(f){const{field:V,operator:N}=f,{fieldtype:j,options:H}=V;if(N=="is")return re($e,{type:"select",options:[{label:"Set",value:"set"},{label:"Not Set",value:"not set"}]});if(N=="timespan")return re($e,{type:"select",options:we});if(["like","not like","in","not in"].includes(N))return re($e,{type:"text"});if(l.includes(j)||o.includes(j)){const U=j=="Check"?["Yes","No"]:S(H);return re($e,{type:"select",options:U.map(Se=>({label:Se,value:Se}))})}else return n.includes(j)?j=="Dynamic Link"?re($e,{type:"text"}):re(Wn,{class:"form-control",doctype:H,value:f.value}):a.includes(j)?re($e,{type:"number"}):r.includes(j)&&N=="between"?re(Pa,{value:f.value}):r.includes(j)?re(j=="Date"?lo:ro,{value:f.value}):re($e,{type:"text"})}function w(f){return l.includes(f.fieldtype)?S(f.options)[0]:o.includes(f.fieldtype)?"Yes":r.includes(f.fieldtype)?null:""}function g(f){return l.includes(f)||o.includes(f)||a.includes(f)?"equals":r.includes(f)?"between":"like"}function S(f){return f.split(`
`)}function m(f){f&&(d.value.add({field:{label:f.label,fieldname:f.value,fieldtype:f.fieldtype,options:f.options},fieldname:f.value,operator:g(f.fieldtype),value:w(f)}),R())}function C(f,V){d.value.delete(Array.from(d.value)[V]),d.value.add({fieldname:f.value,operator:g(f.fieldtype),value:w(f),field:{label:f.label,fieldname:f.value,fieldtype:f.fieldtype,options:f.options}}),R()}function O(f){d.value.delete(Array.from(d.value)[f]),R()}function b(f){d.value.clear(),R(),f()}function ae(f,V){f=f.target?f.target.value:f,V.operator==="between"?V.value=[f.split(",")[0],f.split(",")[1]]:V.value=f,R()}function B(f,V){let N=f.target._value,j=f.target.value;V.operator=f.target.value,$(N,j)||(V.value=w(V.field)),(j==="is"||j==="is not")&&(V.value="set"),R()}function $(f,V){let N=["equals","not equals","in","not in",">","<",">=","<="];return!!(N.includes(f)&&N.includes(V))}function R(){let f=[];d.value.forEach(V=>{f.push({fieldname:V.fieldname,operator:V.operator,value:V.value})}),s("update",me(f))}function me(f){return{...Array.from(f).map(ie).reduce((H,U)=>(["equals","="].includes(U.operator)?H[U.fieldname]=U.value=="Yes"?!0:U.value=="No"?!1:U.value:H[U.fieldname]=[de[U.operator.toLowerCase()],U.value],H),{})}}function ie(f){return f.operator.includes("like")&&!f.value.includes("%")&&(f.value=`%${f.value}%`),f}const de={is:"is","is not":"is not",in:"in","not in":"not in",equals:"=","not equals":"!=",yes:!0,no:!1,like:"LIKE","not like":"NOT LIKE",">":">","<":"<",">=":">=","<=":"<=",between:"between",timespan:"timespan"},ye={is:"is","=":"equals","!=":"not equals",equals:"equals","is not":"is not",true:"yes",false:"no",LIKE:"like","NOT LIKE":"not like",in:"in","not in":"not in",">":">","<":"<",">=":">=","<=":"<=",between:"between",timespan:"timespan"},we=[{label:__("Last Week"),value:"last week"},{label:__("Last Month"),value:"last month"},{label:__("Last Quarter"),value:"last quarter"},{label:__("Last 6 Months"),value:"last 6 months"},{label:__("Last Year"),value:"last year"},{label:__("Yesterday"),value:"yesterday"},{label:__("Today"),value:"today"},{label:__("Tomorrow"),value:"tomorrow"},{label:__("This Week"),value:"this week"},{label:__("This Month"),value:"this month"},{label:__("This Quarter"),value:"this quarter"},{label:__("This Year"),value:"this year"},{label:__("Next Week"),value:"next week"},{label:__("Next Month"),value:"next month"},{label:__("Next Quarter"),value:"next quarter"},{label:__("Next 6 Months"),value:"next 6 months"},{label:__("Next Year"),value:"next year"}];return(f,V)=>{const N=te("Button"),j=te("FeatherIcon");return F(),pe(zt,null,{target:L(()=>{var H;return[_(N,{label:f.__("Filter")},fn({prefix:L(()=>[_(Ha,{class:"h-4"})]),_:2},[(H=d.value)!=null&&H.size?{name:"suffix",fn:L(()=>[D("div",ja,Me(d.value.size),1)]),key:"0"}:void 0]),1032,["label"])]}),body:L(({close:H})=>{var U,Se;return[D("div",Ua,[D("div",za,[(U=d.value)!=null&&U.size?(F(!0),X(Ke,{key:0},at(d.value,(ne,Re)=>(F(),X("div",{key:Re,id:"filter-list",class:"mb-3 flex items-center justify-between gap-2"},[D("div",Xa,[D("div",Wa,Me(Re==0?f.__("Where"):f.__("And")),1),D("div",Ga,[_(ct,{value:ne.field.fieldname,options:ee(p).data,onChange:ve=>C(ve,Re),placeholder:f.__("First Name")},null,8,["value","options","onChange","placeholder"])]),D("div",Za,[_(ee($e),{type:"select",modelValue:ne.operator,"onUpdate:modelValue":ve=>ne.operator=ve,onChange:ve=>B(ve,ne),options:P(ne.field.fieldtype,ne.field.fieldname),placeholder:f.__("Equals")},null,8,["modelValue","onUpdate:modelValue","onChange","options","placeholder"])]),D("div",Ja,[(F(),pe(Xn(I(ne)),{modelValue:ne.value,"onUpdate:modelValue":ve=>ne.value=ve,onChange:ve=>ae(ve,ne),placeholder:f.__("John Doe")},null,40,["modelValue","onUpdate:modelValue","onChange","placeholder"]))])]),_(N,{variant:"ghost",icon:"x",onClick:ve=>O(Re)},null,8,["onClick"])]))),128)):(F(),X("div",Ka,Me(f.__("Empty - Choose a field to filter by")),1)),D("div",Qa,[_(ct,{value:"",options:ee(p).data,onChange:V[0]||(V[0]=ne=>m(ne)),placeholder:f.__("First name")},{target:L(({togglePopover:ne})=>[_(N,{class:"!text-gray-600",variant:"ghost",onClick:Re=>ne(),label:f.__("Add Filter")},{prefix:L(()=>[_(j,{name:"plus",class:"h-4"})]),_:2},1032,["onClick","label"])]),_:1},8,["options","placeholder"]),(Se=d.value)!=null&&Se.size?(F(),pe(N,{key:0,class:"!text-gray-600",variant:"ghost",label:f.__("Clear all Filter"),onClick:ne=>b(H)},null,8,["label","onClick"])):Be("",!0)])])])]}),_:1})}}},tl={__name:"SearchBar",props:{value:String,placeholderText:{type:String}},emits:["update:modelValue"],setup(t,{emit:e}){const o=t,n=e,a=oe(o.value);return ze(a,(l,i)=>{n("update:modelValue",l)}),(l,i)=>{const r=te("FeatherIcon"),u=te("TextInput");return F(),pe(u,{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=s=>a.value=s),placeholder:t.placeholderText,type:"text"},{suffix:L(()=>[_(r,{class:"w-4",name:"search"})]),_:1},8,["modelValue","placeholder"])}}},nl={},ol={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},al=D("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.07548 1.50005C8.05087 1.49632 8.02566 1.49438 8 1.49438C7.97434 1.49438 7.94914 1.49632 7.92452 1.50005H3C1.89543 1.50005 1 2.39548 1 3.50005V12.5C1 13.6046 1.89543 14.5 3 14.5H7.92511C7.94954 14.5037 7.97455 14.5056 8 14.5056C8.02545 14.5056 8.05046 14.5037 8.07489 14.5H13C14.1046 14.5 15 13.6046 15 12.5V3.50005C15 2.39548 14.1046 1.50005 13 1.50005H8.07548ZM7.5 2.50005H3C2.44772 2.50005 2 2.94776 2 3.50005V12.5C2 13.0523 2.44772 13.5 3 13.5H7.5L7.5 2.50005ZM8.5 13.5L8.5 2.50005H13C13.5523 2.50005 14 2.94776 14 3.50005V12.5C14 13.0523 13.5523 13.5 13 13.5H8.5Z",fill:"currentColor"},null,-1),ll=[al];function rl(t,e){return F(),X("svg",ol,ll)}const il=Ae(nl,[["render",rl]]),sl={},ul={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},cl=D("path",{d:"M2.35619 8.42909C2.35644 9.77009 2.84031 11.066 3.719 12.079C4.5977 13.092 5.81226 13.7542 7.13977 13.9439C8.46729 14.1336 9.8187 13.8382 10.946 13.1119C12.0732 12.3856 12.9008 11.2771 13.2766 9.98982C13.6525 8.70258 13.5515 7.32295 12.9922 6.10414C12.4329 4.88534 11.4528 3.90914 10.2318 3.35469C9.0108 2.80025 7.63079 2.70476 6.34504 3.08576C5.0593 3.46675 3.95409 4.29867 3.23226 5.42883",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),dl=D("path",{d:"M3.21297 2V5.42886H6.64183",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),fl=[cl,dl];function hl(t,e){return F(),X("svg",ul,fl)}const dn=Ae(sl,[["render",hl]]),pl={class:"my-2 rounded-lg border border-gray-100 bg-white p-1.5 shadow-xl"},ml={key:0},vl={class:"flex cursor-grab items-center justify-between gap-6 rounded px-2 py-1.5 text-base text-gray-800 hover:bg-gray-100"},gl={class:"flex items-center gap-2"},_l={class:"flex cursor-pointer items-center gap-1"},bl={class:"mt-1.5 flex flex-col gap-1 border-t pt-1.5"},yl={key:1},wl={class:"flex flex-col items-center justify-between gap-2 rounded px-2 py-1.5 text-base text-gray-800"},Cl={class:"flex flex-col items-center gap-3"},Dl={class:"flex w-full gap-2 border-t pt-2"},El={__name:"ColumnSettings",props:Oe({doctype:{type:String,required:!0}},{modelValue:{},modelModifiers:{}}),emits:Oe(["update"],["update:modelValue"]),setup(t,{emit:e}){const o=e,n=oe(!1),a=oe({columns:[],rows:[],isDefault:!1}),l=Ve(t,"modelValue"),i=oe(!1),r=oe({old:{},label:"",key:"",width:"10rem"}),u=he({get:()=>{var m,C;return(C=(m=l.value)==null?void 0:m.data)==null?void 0:C.is_default},set:m=>{l.value.data.is_default=m}}),s=he({get:()=>{var m,C;return(C=(m=l.value)==null?void 0:m.data)==null?void 0:C.columns},set:m=>{l.value.data.columns=m}}),h=he({get:()=>{var m,C;return(C=(m=l.value)==null?void 0:m.data)==null?void 0:C.rows},set:m=>{l.value.data.rows=m}}),p=he(()=>{var C,O;let m=(O=(C=l.value)==null?void 0:C.data)==null?void 0:O.fields;return m?m.filter(b=>!s.value.find(ae=>ae.key===b.value)):[]});function d(m){let C={label:m.label,type:m.type,key:m.value,width:"10rem"};s.value.push(C),h.value.push(m.value),S(!0)}function E(m){s.value=s.value.filter(C=>C.key!==m.key),m.key!=="name"&&(h.value=h.value.filter(C=>C!==m.key)),S()}function T(m){i.value=!0,r.value=m,r.value.old={...m}}function P(m){i.value=!1;let C=s.value.findIndex(O=>O.key===m.key);s.value[C].label=m.label,s.value[C].width=m.width,s.value[C].old&&delete s.value[C].old,S()}function I(){i.value=!1,r.value.label=r.value.old.label,r.value.width=r.value.old.width,delete r.value.old}function w(m){S(!0,!1,!0),m()}function g(m){S(!0,!0),m()}function S(m=!1,C=!1,O=!1){u.value=C,n.value=!0;let b={columns:O?a.value.columns:s.value,rows:O?a.value.rows:h.value,isDefault:O?a.value.isDefault:C,reload:m,reset:O};o("update",b),m&&setTimeout(()=>{u.value=O?a.value.isDefault:C,n.value=!O},100)}return Gn(()=>l.value.data,m=>{m&&(a.value.columns=JSON.parse(JSON.stringify(m.columns)),a.value.rows=JSON.parse(JSON.stringify(m.rows)),a.value.isDefault=m.is_default)}),(m,C)=>{const O=te("Button"),b=te("FeatherIcon"),ae=te("FormControl");return F(),pe(zt,null,{target:L(()=>[_(O,{label:m.__("Columns")},{prefix:L(()=>[_(il,{class:"h-4"})]),_:1},8,["label"])]),body:L(({close:B})=>[D("div",pl,[i.value?(F(),X("div",yl,[D("div",wl,[D("div",Cl,[_(ae,{type:"text",size:"md",label:m.__("Label"),modelValue:r.value.label,"onUpdate:modelValue":C[1]||(C[1]=$=>r.value.label=$),class:"w-full",placeholder:m.__("First Name")},null,8,["label","modelValue","placeholder"]),_(ae,{type:"text",size:"md",label:m.__("Width"),class:"w-full",modelValue:r.value.width,"onUpdate:modelValue":C[2]||(C[2]=$=>r.value.width=$),placeholder:"10rem",description:m.__("Width can be in number, pixel or rem (eg. 3, 30px, 10rem)"),debounce:500},null,8,["label","modelValue","description"])]),D("div",Dl,[_(O,{variant:"subtle",label:m.__("Cancel"),class:"w-full flex-1",onClick:I},null,8,["label"]),_(O,{variant:"solid",label:m.__("Update"),class:"w-full flex-1",onClick:C[3]||(C[3]=$=>P(r.value))},null,8,["label"])])])])):(F(),X("div",ml,[_(ee(io),{list:s.value,onEnd:S,"item-key":"key",class:"list-group"},{item:L(({element:$})=>[D("div",vl,[D("div",gl,[_(pn,{class:"h-3.5"}),D("div",null,Me(m.__($.label)),1)]),D("div",_l,[_(O,{variant:"ghost",class:"!h-5 w-5 !p-1",onClick:R=>T($)},{default:L(()=>[_(hn,{class:"h-3.5"})]),_:2},1032,["onClick"]),_(O,{variant:"ghost",class:"!h-5 w-5 !p-1",onClick:R=>E($)},{default:L(()=>[_(b,{name:"x",class:"h-3.5"})]),_:2},1032,["onClick"])])])]),_:1},8,["list"]),D("div",bl,[_(ct,{value:"",options:p.value,onChange:C[0]||(C[0]=$=>d($))},{target:L(({togglePopover:$})=>[_(O,{class:"w-full !justify-start !text-gray-600",variant:"ghost",onClick:R=>$(),label:m.__("Add Column")},{prefix:L(()=>[_(b,{name:"plus",class:"h-4"})]),_:2},1032,["onClick","label"])]),_:1},8,["options"]),n.value?(F(),pe(O,{key:0,class:"w-full !justify-start !text-gray-600",variant:"ghost",onClick:$=>w(B),label:m.__("Reset Changes")},{prefix:L(()=>[_(dn,{class:"h-4"})]),_:2},1032,["onClick","label"])):Be("",!0),u.value?Be("",!0):(F(),pe(O,{key:1,class:"w-full !justify-start !text-gray-600",variant:"ghost",onClick:$=>g(B),label:m.__("Reset to Default")},{prefix:L(()=>[_(dn,{class:"h-4"})]),_:2},1032,["onClick","label"]))])]))])]),_:1})}}},xl={class:"flex items-center justify-between px-5 py-4"},kl={class:"flex items-center gap-2"},Sl={class:"flex items-center gap-2"},Tl={key:0,class:"flex items-center gap-2 border-r pr-2"},Vl={class:"flex items-center gap-2"},Ml={class:"mt-3"},$l={__name:"ViewControls",props:Oe({doctype:{type:String,required:!0},filters:{type:Object,default:{}},options:{type:Object,default:{hideColumnsButton:!1,defaultViewName:""}},showElement:{type:Boolean,default:!1},placeholderText:{type:String},showFuncImport:{type:Boolean,default:!1},showFuncConvertTaskCustomer:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{},loadMore:{},loadMoreModifiers:{},resizeColumn:{},resizeColumnModifiers:{},updatedPageCount:{},updatedPageCountModifiers:{}}),emits:Oe(["showImportModal","afterConvertTaskCustomer"],["update:modelValue","update:loadMore","update:resizeColumn","update:updatedPageCount"]),setup(t,{expose:e,emit:o}){var Jt;const n=t,{showFuncImport:a,showFuncConvertTaskCustomer:l}=Zn(n),i=he(()=>{let c=[{label:__("Export"),icon:()=>re(Fe,{name:"download",class:"h-4 w-4"}),onClick:()=>we()}];return a.value&&c.unshift({label:__("Import"),icon:()=>re(Fe,{name:"upload",class:"h-4 w-4"}),onClick:()=>j()}),l.value&&c.push({label:__("Bn giao cng vic"),icon:()=>re(Fe,{name:"arrow-right",class:"h-4 w-4"}),onClick:()=>f()}),c}),r=oe(""),{$dialog:u}=Jn(),{reload:s,getView:h}=Kn(),{isManager:p}=Qn(),d=Ve(t,"modelValue"),E=Ve(t,"loadMore"),T=Ve(t,"resizeColumn"),P=Ve(t,"updatedPageCount"),I=eo(),w=to(),g=oe(""),S=oe(!1),m=oe(!1),C=oe(!1),O=he(()=>{var y;let c=h(I.query.view);return{label:(c==null?void 0:c.label)||((y=n.options)==null?void 0:y.defaultViewName)||"List View",icon:(c==null?void 0:c.icon)||"list"}}),b=oe({name:"",label:"",filters:{},order_by:"creation desc",columns:"",rows:"",load_default_columns:!1,pinned:!1,public:!1,searchText:""}),ae=he(()=>{var c,y;return(y=(c=d.value)==null?void 0:c.data)==null?void 0:y.page_length}),B=he(()=>{var c,y;return(y=(c=d.value)==null?void 0:c.data)==null?void 0:y.page_length_count});ze(E,c=>{c&&Zt(c,!0)}),ze(T,c=>{c&&ve()}),ze(P,c=>{c&&Zt(c)});function $(){let c=h(I.query.view,n.doctype);const y=(c==null?void 0:c.filters)&&JSON.parse(c.filters)||{},W=(c==null?void 0:c.order_by)||"creation desc",se=(c==null?void 0:c.columns)||"",Te=(c==null?void 0:c.rows)||"",A=(c==null?void 0:c.searchText)||"";return c?b.value={name:c.name,label:c.label,filters:c.filters,order_by:c.order_by,columns:c.columns,rows:c.rows,route_name:c.route_name,load_default_columns:c.row,pinned:c.pinned,public:c.public,searchText:A}:b.value={name:"",label:"",filters:{},order_by:"creation desc",columns:"",rows:"",route_name:"",load_default_columns:!0,pinned:!1,public:!1,searchText:""},{doctype:n.doctype,filters:y,order_by:W,columns:se,rows:Te,page_length:ae.value,page_length_count:B.value,custom_view_name:(c==null?void 0:c.name)||"",default_filters:n.filters,searchText:A}}d.value=jt({url:"crm.api.doc.get_list_data",params:$(),cache:[n.doctype,I.query.view],transform(c){return{...c,params:$()}},onSuccess(c){let y=h(I.query.view),W=d.value.params?d.value.params:$();g.value={doctype:n.doctype,filters:W.filters,order_by:W.order_by,page_length:W.page_length,page_length_count:W.page_length_count,columns:c.columns,rows:c.rows,custom_view_name:(y==null?void 0:y.name)||"",default_filters:n.filters},console.log(c)}}),Ut(()=>no(me,100)());const R=he(()=>{var c;return(c=d.value)==null?void 0:c.loading});function me(){d.value.params=$(),d.value.reload()}const ie=oe(!1),de=oe("Excel"),ye=oe(!1);function we(){ie.value=!0}function f(){C.value=!0}async function V(){let c=JSON.stringify(d.value.data.columns.map(Te=>Te.key)),y=JSON.stringify(d.value.params.filters),W=d.value.params.order_by,se=d.value.params.page_length;ye.value&&(se=d.value.data.total_count),window.location.href=`/api/method/frappe.desk.reportview.export_query?file_format_type=${de.value}&title=${n.doctype}&doctype=${n.doctype}&fields=${c}&filters=${y}&order_by=${W}&page_length=${se}&start=0&view=Report&with_comment_count=1`,ie.value=!1,ye.value=!1,de.value="Excel"}const N=o;function j(){N("showImportModal",!0)}const H=[{label:__((Jt=n.options)==null?void 0:Jt.defaultViewName)||__("List View"),icon:"list",onClick(){S.value=!1,w.push({name:I.name})}}],U=he(()=>{var y,W;let c=[{group:__("Default Views"),hideLabel:!0,items:H}];if((W=(y=d.value)==null?void 0:y.data)!=null&&W.views){d.value.data.views.forEach(J=>{J.label=__(J.label),J.icon=J.icon||"list",J.filters=typeof J.filters=="string"?JSON.parse(J.filters):J.filters,J.onClick=()=>{S.value=!1,w.push({...I,query:{view:J.name}})}});let se=d.value.data.views.filter(J=>J.public),Te=d.value.data.views.filter(J=>!J.pinned&&!J.public&&!J.is_default),A=d.value.data.views.filter(J=>J.pinned);se.length&&c.push({group:__("Public Views"),items:se}),Te.length&&c.push({group:__("Saved Views"),items:Te}),A.length&&c.push({group:"Ch  xem ghim",items:A})}return c}),Se=so(()=>{S.value=!0,g.value||(g.value=$()),d.value.params=g.value,r.value?(d.value.params.searchText=r.value,b.value.searchText=r.value):(d.value.params.searchText="",b.value.searchText=""),d.value.reload()},700);function ne(c){S.value=!0,g.value||(g.value=$()),d.value.params=g.value,d.value.params.filters=c,b.value.filters=c,d.value.reload(),I.query.view||Tt()}function Re(c){S.value=!0,g.value||(g.value=$()),d.value.params=g.value,d.value.params.order_by=c,b.value.order_by=c,d.value.reload(),I.query.view||Tt()}function ve(c){c||(c={columns:d.value.data.columns,rows:d.value.data.rows,isDefault:!1}),g.value||(g.value=$()),g.value.columns=b.value.columns=c.isDefault?"":c.columns,g.value.rows=b.value.rows=c.isDefault?"":c.rows,b.value.load_default_columns=c.isDefault,c.reset&&(g.value.columns=$().columns,g.value.rows=$().rows),c.reload&&(d.value.params=g.value,d.value.reload()),S.value=!0,I.query.view||Tt()}function Tt(){I.query.view||(b.value.doctype=n.doctype,Ze("crm.fcrm.doctype.crm_view_settings.crm_view_settings.create_or_update_default_view",{view:b.value}).then(()=>{s(),b.value={label:b.value.label,name:b.value.name,filters:g.value.filters,order_by:g.value.order_by,columns:g.value.columns,rows:g.value.rows,route_name:I.name,load_default_columns:b.value.load_default_columns},S.value=!1}))}function Zt(c,y=!1){if(g.value||(g.value=$()),d.value.params=g.value,y)d.value.params.page_length+=d.value.params.page_length_count;else{if(c==d.value.params.page_length&&c==d.value.params.page_length_count)return;d.value.params.page_length=c,d.value.params.page_length_count=c}d.value.reload()}const Vn=he(()=>{let c=[{group:__("Default Views"),hideLabel:!0,items:[{label:__("Duplicate"),icon:()=>re(Co,{class:"h-4 w-4"}),onClick:()=>Mn()}]}];return I.query.view&&(!b.value.public||p())&&(c[0].items.push({label:__("Rename"),icon:()=>re(hn,{class:"h-4 w-4"}),onClick:()=>In()}),b.value.public||c[0].items.push({label:b.value.pinned?__("Unpin View"):__("Pin View"),icon:()=>re(b.value.pinned?Vo:oo,{class:"h-4 w-4"}),onClick:()=>Nn()}),p()&&c[0].items.push({label:b.value.public?__("Make Private"):__("Make Public"),icon:()=>re(Fe,{name:b.value.public?"lock":"unlock",class:"h-4 w-4"}),onClick:()=>On()}),c.push({group:__("Delete View"),hideLabel:!0,items:[{label:__("Delete"),icon:"trash-2",onClick:()=>u({title:__("Delete View"),message:__("Are you sure you want to delete this view?"),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:y=>An(y)}]})}]})),c});function Mn(){var y;let c=__((y=h(I.query.view))==null?void 0:y.label)||__("List View");b.value.name="",b.value.label=`${c} (${__("New")})`,m.value=!0}function In(){b.value.name=I.query.view,b.value.label=__(h(I.query.view).label),m.value=!0}function On(){Ze("crm.fcrm.doctype.crm_view_settings.crm_view_settings.public",{name:I.query.view,value:!b.value.public}).then(()=>{b.value.public=!b.value.public,s()})}function Nn(){Ze("crm.fcrm.doctype.crm_view_settings.crm_view_settings.pin",{name:I.query.view,value:!b.value.pinned}).then(()=>{b.value.pinned=!b.value.pinned,s()})}function An(c){Ze("crm.fcrm.doctype.crm_view_settings.crm_view_settings.delete",{name:I.query.view}).then(()=>{w.push({name:I.name}),s()}),c()}function Pn(){me(),S.value=!1}function $n(){b.value={label:b.value.label,name:b.value.name,filters:g.value.filters,order_by:g.value.order_by,columns:g.value.columns,rows:g.value.rows,route_name:I.name,load_default_columns:b.value.load_default_columns},m.value=!0}function Fn({event:c,idx:y,column:W,item:se}){if(["Duration","Datetime","Time"].includes(W.type)||y===0)return;c.stopPropagation(),c.preventDefault();let A={...d.value.params.filters},J=se.name||se.label||se;if(J?A[W.key]=J:delete A[W.key],W.key=="_assign")if(se.length>1){let Kt=c.target.closest(".user-avatar");if(Kt){let qn=Kt.getAttribute("data-name");A._assign=["LIKE",`%${qn}%`]}}else A._assign=["LIKE",`%${se[0].name}%`];ne(A)}e({applyFilter:Fn}),ze(()=>h(I.query.view),(c,y)=>{JSON.stringify(c)!==JSON.stringify(y)&&me()},{deep:!0}),ze(()=>I,(c,y)=>{c!==y&&me()});function Ln(){N("afterConvertTaskCustomer")}return(c,y)=>{const W=te("Button"),se=te("FormControl"),Te=te("Dialog");return F(),X(Ke,null,[D("div",xl,[D("div",kl,[_(ee(Vt),{options:U.value},{default:L(({open:A})=>[_(W,{label:c.__(O.value.label)},{prefix:L(()=>[_(ee(Fe),{name:O.value.icon,class:"h-4"},null,8,["name"])]),suffix:L(()=>[_(ee(Fe),{name:A?"chevron-up":"chevron-down",class:"h-4 text-gray-600"},null,8,["name"])]),_:2},1032,["label"])]),_:1},8,["options"]),_(ee(Vt),{options:Vn.value},{default:L(()=>[_(W,null,{default:L(()=>[_(ee(Fe),{name:"more-horizontal",class:"h-4 w-4"})]),_:1})]),_:1},8,["options"])]),D("div",Sl,[S.value&&ee(I).query.view&&(!b.value.public||ee(p)())?(F(),X("div",Tl,[_(W,{label:c.__("Cancel"),onClick:Pn},null,8,["label"]),_(W,{label:c.__("Save Changes"),onClick:$n},null,8,["label"])])):Be("",!0),D("div",Vl,[t.showElement?(F(),pe(tl,{key:0,placeholderText:t.placeholderText,modelValue:r.value,"onUpdate:modelValue":[y[0]||(y[0]=A=>r.value=A),ee(Se)]},null,8,["placeholderText","modelValue","onUpdate:modelValue"])):Be("",!0),_(W,{label:c.__("Refresh"),onClick:y[1]||(y[1]=A=>me()),loading:R.value},{icon:L(()=>[_(vo,{class:"h-4 w-4"})]),_:1},8,["label","loading"]),_(el,{modelValue:d.value,"onUpdate:modelValue":y[2]||(y[2]=A=>d.value=A),doctype:t.doctype,default_filters:t.filters,onUpdate:ne},null,8,["modelValue","doctype","default_filters"]),_(Da,{modelValue:d.value,"onUpdate:modelValue":y[3]||(y[3]=A=>d.value=A),doctype:t.doctype,onUpdate:Re},null,8,["modelValue","doctype"]),t.options.hideColumnsButton?Be("",!0):(F(),pe(El,{key:1,modelValue:d.value,"onUpdate:modelValue":y[4]||(y[4]=A=>d.value=A),doctype:t.doctype,onUpdate:y[5]||(y[5]=A=>ve(A))},null,8,["modelValue","doctype"])),t.options.hideColumnsButton?Be("",!0):(F(),pe(ee(Vt),{key:2,options:[{group:c.__("Options"),hideLabel:!0,items:i.value}]},{default:L(()=>[_(W,null,{default:L(()=>[_(ee(Fe),{name:"more-horizontal",class:"h-4 w-4"})]),_:1})]),_:1},8,["options"]))])])]),_(Mo,{doctype:t.doctype,options:{afterCreate:async A=>{await ee(s)(),S.value=!1,ee(w).push({name:ee(I).name,query:{view:A.name}})},afterUpdate:()=>{S.value=!1,ee(s)()}},view:b.value,"onUpdate:view":y[6]||(y[6]=A=>b.value=A),modelValue:m.value,"onUpdate:modelValue":y[7]||(y[7]=A=>m.value=A)},null,8,["doctype","options","view","modelValue"]),_(Te,{modelValue:ie.value,"onUpdate:modelValue":y[10]||(y[10]=A=>ie.value=A),options:{title:c.__("Export"),actions:[{label:c.__("Download"),variant:"solid",onClick:()=>V()}]}},{"body-content":L(()=>[_(se,{variant:"outline",label:c.__("Export Type"),type:"select",options:[{label:c.__("Excel"),value:"Excel"},{label:c.__("CSV"),value:"CSV"}],modelValue:de.value,"onUpdate:modelValue":y[8]||(y[8]=A=>de.value=A),placeholder:c.__("Excel")},null,8,["label","options","modelValue","placeholder"]),D("div",Ml,[_(se,{type:"checkbox",label:c.__("Export All {0} Record(s)",[d.value.data.total_count]),modelValue:ye.value,"onUpdate:modelValue":y[9]||(y[9]=A=>ye.value=A)},null,8,["label","modelValue"])])]),_:1},8,["modelValue","options"]),_(ao,{modelValue:C.value,"onUpdate:modelValue":y[11]||(y[11]=A=>C.value=A),onAfterConvertTask:y[12]||(y[12]=A=>Ln())},null,8,["modelValue"])],64)}}};export{$l as _};
//# sourceMappingURL=ViewControls-a6883ed1.js.map
