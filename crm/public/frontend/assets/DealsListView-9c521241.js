import{_ as O}from"./statuses-0b6a309e.js";import{I as J}from"./IndicatorIcon-a9637858.js";import{m as R,u as U,a as G,g as H,w as K,r as b,o as Q,s as X,c as x,b as z,d as D,e as a,f as u,h as i,i as p,j as d,F as I,k as Y,l as v,n as E,p as N,q as g,P as Z,t as ee,v as te,x as P,D as le}from"./index-f37caafa.js";import{_ as ae}from"./EditValueModal-7abde7ae.js";import{_ as se,a as oe,b as ne,c as ie,d as re,e as ue}from"./ListView-1d2bb051.js";import{_ as de}from"./DatePicker-6aa96864.js";const ce={key:0,class:"flex items-center"},me=["onClick"],_e=["onClick"],ke=["onClick"],fe=["onClick"],pe=["onClick"],ve={key:1,class:"truncate text-base"},ye={key:2},Ce=["onClick"],Ae={__name:"DealsListView",props:R({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:R(["loadMore","updatePageCount","columnWidthUpdated","applyFilter"],["update:modelValue","update:list"]),setup(c,{expose:T,emit:q}){const w=q,h=U(c,"modelValue"),k=U(c,"list"),M=G(),{$dialog:V}=H();K(h,(l,e)=>{l!==e&&w("updatePageCount",l)});const $=b(!1),F=b([]),A=b(()=>{});function f(l,e,n,_){["mobile_no","email","lead_name"].includes(n.key)||w("applyFilter",{event:l,idx:e,column:n,item:_})}function S(l,e){F.value=l,$.value=!0,A.value=e}function W(l,e){V({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s)?",[l.size]),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:n=>{x("frappe.desk.reportview.delete_items",{items:JSON.stringify(Array.from(l)),doctype:"CRM Deal"}).then(()=>{z({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),e(),k.value.reload(),n()})}}]})}const B=b([]),L=b([]);function j(l,e){let n=[{label:__("Edit"),onClick:()=>S(l,e)},{label:__("Delete"),onClick:()=>W(l,e)}];return B.value.forEach(_=>{n.push({label:__(_.label),onClick:()=>_.onClick({list:k.value,selections:l,unselectAll:e,call:x,createToast:z,$dialog:V,router:M})})}),n}return Q(()=>{var l,e,n,_,y;(l=k.value)!=null&&l.data&&(X(k.value.data,{list:k.value,call:x,createToast:z,$dialog:V,router:M}),B.value=((n=(e=k.value)==null?void 0:e.data)==null?void 0:n.bulkActions)||[],L.value=((y=(_=k.value)==null?void 0:_.data)==null?void 0:y.listActions)||[])}),T({customListActions:L}),(l,e)=>{const n=D("Badge"),_=D("FormControl"),y=D("Button");return a(),u(I,null,[i(d(ue),{class:E(l.$attrs.class),columns:c.columns,rows:c.rows,options:{getRowRoute:o=>({name:"Deal",params:{dealId:o.name}}),selectable:c.options.selectable,showTooltip:c.options.showTooltip,resizeColumn:c.options.resizeColumn},"row-key":"name"},{default:p(()=>[i(d(se),{class:"mx-5",onColumnWidthUpdated:e[0]||(e[0]=o=>w("columnWidthUpdated"))}),i(d(oe),{id:"list-rows"},{default:p(()=>[(a(!0),u(I,null,Y(c.rows,o=>(a(),v(d(ie),{class:"mx-5",key:o.name,row:o},{default:p(({idx:m,column:s,item:t})=>[s.key==="_assign"?(a(),u("div",ce,[i(O,{avatars:t,size:"sm",onClick:r=>f(r,m,s,t)},null,8,["avatars","onClick"])])):(a(),v(d(ne),{key:1,item:t},{prefix:p(()=>[s.key==="status"?(a(),u("div",{key:0,onClick:r=>f(r,m,s,t)},[i(J,{class:E(t.color)},null,8,["class"])],8,me)):s.key==="organization"?(a(),u("div",{key:1,onClick:r=>f(r,m,s,t)},[t.label?(a(),v(d(N),{key:0,class:"flex items-center",image:t.logo,label:t.label,size:"sm"},null,8,["image","label"])):g("",!0)],8,_e)):s.key==="deal_owner"?(a(),u("div",{key:2,onClick:r=>f(r,m,s,t)},[t.full_name?(a(),v(d(N),{key:0,class:"flex items-center",image:t.user_image,label:t.full_name,size:"sm"},null,8,["image","label"])):g("",!0)],8,ke)):s.key==="mobile_no"?(a(),u("div",{key:3,onClick:r=>f(r,m,s,t)},[i(Z,{class:"h-4 w-4"})],8,fe)):g("",!0)]),default:p(({label:r})=>[["modified","creation","first_response_time","first_responded_on","response_by"].includes(s.key)?(a(),u("div",{key:0,class:"truncate text-base",onClick:C=>f(C,m,s,t)},[i(d(ee),{text:t.label},{default:p(()=>[te("div",null,P(t.timeAgo),1)]),_:2},1032,["text"])],8,pe)):s.key==="sla_status"?(a(),u("div",ve,[t.value?(a(),v(n,{key:0,variant:"subtle",theme:t.color,size:"md",label:t.value,onClick:C=>f(C,m,s,t)},null,8,["theme","label","onClick"])):g("",!0)])):s.type==="Check"?(a(),u("div",ye,[i(_,{type:"checkbox",modelValue:t,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):(a(),u("div",{key:3,class:"truncate text-base",onClick:C=>f(C,m,s,t)},P(l.__(r)),9,Ce))]),_:2},1032,["item"]))]),_:2},1032,["row"]))),128))]),_:1}),i(d(re),null,{actions:p(({selections:o,unselectAll:m})=>[i(d(le),{options:j(o,m)},{default:p(()=>[i(y,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),h.value?(a(),v(d(de),{key:0,class:"border-t px-5 py-2",modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=o=>h.value=o),options:{rowCount:c.options.rowCount,totalCount:c.options.totalCount},onLoadMore:e[2]||(e[2]=o=>w("loadMore"))},null,8,["modelValue","options"])):g("",!0),i(ae,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=o=>$.value=o),unselectAll:A.value,"onUpdate:unselectAll":e[4]||(e[4]=o=>A.value=o),doctype:"CRM Deal",selectedValues:F.value,onReload:e[5]||(e[5]=o=>k.value.reload())},null,8,["modelValue","unselectAll","selectedValues"])],64)}}};export{Ae as _};
//# sourceMappingURL=DealsListView-9c521241.js.map
