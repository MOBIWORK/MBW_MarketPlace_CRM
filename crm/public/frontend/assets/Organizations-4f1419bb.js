import{_ as j}from"./CustomActions-78928ae0.js";import{z as D,A as q,B as E,C as J,D as X,E as G,G as d,H,I as K,J as N,K as P,s as F,o as u,b as v,f as s,w as m,u as r,F as T,x as Q,a as O,L as Y,k as L,M as Z,d as S,t as U,N as ee,aX as te,c as I,ah as ae,X as oe,W as le,ae as ne,$ as se}from"./index-fd4111d0.js";import{_ as ie,a as ue}from"./LayoutHeader-4431816a.js";import{_ as re}from"./OrganizationModal-1758a6c2.js";import{_ as de}from"./EditValueModal-3deb1bd3.js";import{_ as me,a as pe,b as ce,c as fe,e as ve,d as _e}from"./ListView-dc019d7b.js";import{_ as ge}from"./DatePicker-808a1e66.js";import{_ as Ce}from"./ViewControls-fd4f1e0f.js";import"./Fields-0f4da799.js";import"./EditIcon-fc06c5a8.js";import"./IndicatorIcon-b09272ab.js";import"./label-3c481436.js";import"./DatetimePicker-76bd67f8.js";const ye={key:0},be=["onClick"],we={key:1},ke={key:2},ze=["onClick"],Ve={__name:"OrganizationsListView",props:D({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:D(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","update:selections"],["update:modelValue","update:list"]),setup(p,{expose:R,emit:z}){const c=z,{getUser:$}=q(),g=E(p,"modelValue"),_=E(p,"list"),i=J(),{$dialog:y}=X();G(g,(l,e)=>{l!==e&&c("updatePageCount",l)});const C=d(!1),b=d([]),w=d(()=>{});function x(l,e){b.value=l,C.value=!0,w.value=e}function h(l,e){y({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s)?",[l.size]),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:t=>{N("frappe.desk.reportview.delete_items",{items:JSON.stringify(Array.from(l)),doctype:"CRM Organization"}).then(()=>{P({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),e(),_.value.reload(),t()})}}]})}const A=d([]);function n(l,e){return[{label:__("Edit"),onClick:()=>x(l,e)},{label:__("Delete"),onClick:()=>h(l,e)}]}function a(l){let e=[];l.forEach(t=>{e.push(t)}),c("update:selections",e)}return H(()=>{var l,e,t;(l=_.value)!=null&&l.data&&(K(_.value.data,{list:_.value,call:N,createToast:P,$dialog:y,router:i}),A.value=((t=(e=_.value)==null?void 0:e.data)==null?void 0:t.listActions)||[])}),R({customListActions:A}),(l,e)=>{const t=F("FormControl"),V=F("Button");return u(),v(T,null,[s(r(_e),{columns:p.columns,rows:p.rows,options:{getRowRoute:o=>({name:"Organization",params:{organizationId:o.name}}),selectable:p.options.selectable,showTooltip:p.options.showTooltip,resizeColumn:p.options.resizeColumn},"row-key":"name","onUpdate:selections":e[1]||(e[1]=o=>a(o))},{default:m(()=>[s(r(me),{class:"mx-5",onColumnWidthUpdated:e[0]||(e[0]=o=>c("columnWidthUpdated"))}),s(r(pe),{id:"list-rows"},{default:m(()=>[(u(!0),v(T,null,Q(p.rows,o=>(u(),O(r(fe),{class:"mx-5",key:o.name,row:o},{default:m(({idx:M,column:k,item:f})=>[s(r(ce),{item:f},{prefix:m(()=>[k.key==="organization_name"?(u(),v("div",ye,[f.label?(u(),O(r(Y),{key:0,class:"flex items-center",image:f.logo,label:f.label,size:"sm"},null,8,["image","label"])):L("",!0)])):L("",!0)]),default:m(({label:W})=>[["modified","creation"].includes(k.key)?(u(),v("div",{key:0,class:"truncate text-base",onClick:B=>c("applyFilter",{event:B,idx:M,column:k,item:f})},[s(r(Z),{text:f.label},{default:m(()=>[S("div",null,U(f.timeAgo),1)]),_:2},1032,["text"])],8,be)):k.type==="Check"?(u(),v("div",we,[s(t,{type:"checkbox",modelValue:f,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):["modified_by","owner"].includes(k.key)?(u(),v("div",ke,[S("div",null,U(r($)(f).first_name),1)])):(u(),v("div",{key:3,class:"truncate text-base",onClick:B=>c("applyFilter",{event:B,idx:M,column:k,item:f})},U(l.__(W)),9,ze))]),_:2},1032,["item"])]),_:2},1032,["row"]))),128))]),_:1}),s(r(ve),null,{actions:m(({selections:o,unselectAll:M})=>[s(r(ee),{options:n(o,M)},{default:m(()=>[s(V,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),s(r(ge),{class:"border-t px-5 py-2",modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=o=>g.value=o),options:{rowCount:p.options.rowCount,totalCount:p.options.totalCount},onLoadMore:e[3]||(e[3]=o=>c("loadMore"))},null,8,["modelValue","options"]),s(de,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=o=>C.value=o),unselectAll:w.value,"onUpdate:unselectAll":e[5]||(e[5]=o=>w.value=o),doctype:"CRM Organization",selectedValues:b.value,onReload:e[6]||(e[6]=o=>_.value.reload())},null,8,["modelValue","unselectAll","selectedValues"])],64)}}},$e={key:1,class:"flex h-full items-center justify-center"},xe={class:"flex flex-col items-center gap-3 text-xl font-medium text-gray-500"},Ee={__name:"Organizations",setup(p){const R=te(),z=d(null),c=d(!1),$=d([]),g=I(()=>{var n,a,l;return(l=(a=(n=i.value)==null?void 0:n.data)==null?void 0:a.data)==null?void 0:l.find(e=>e.name===R.params.organizationId)}),_=I(()=>{let n=[{label:__("Organizations"),route:{name:"Organizations"}}];return g.value&&n.push({label:__(g.value.name),route:{name:"Organization",params:{organizationId:g.value.name}}}),n}),i=d({}),y=d(1),C=d(1),b=d(20),w=d(null),x=I(()=>{var n,a,l;return(a=(n=i.value)==null?void 0:n.data)!=null&&a.data?(l=i.value)==null?void 0:l.data.data.map(e=>{var V;let t={};return(V=i.value)==null||V.data.rows.forEach(o=>{t[o]=e[o],o==="organization_name"?t[o]={label:e.organization_name,logo:e.organization_logo}:o==="website"?t[o]=h(e.website):o==="annual_revenue"?t[o]=ae(e.annual_revenue):["modified","creation"].includes(o)&&(t[o]={label:oe(e[o],se),timeAgo:__(le(e[o]))})}),t}):[]});function h(n){return n&&n.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"")}function A(n){$.value=n}return(n,a)=>{const l=F("FeatherIcon"),e=F("Button");return u(),v(T,null,[s(ie,null,{"left-header":m(()=>[s(r(ue),{items:_.value},null,8,["items"])]),"right-header":m(()=>{var t;return[(t=z.value)!=null&&t.customListActions?(u(),O(j,{key:0,actions:z.value.customListActions},null,8,["actions"])):L("",!0),s(e,{variant:"solid",label:n.__("Create"),onClick:a[0]||(a[0]=V=>c.value=!0)},{prefix:m(()=>[s(l,{name:"plus",class:"h-4"})]),_:1},8,["label"])]}),_:1}),s(Ce,{ref_key:"viewControls",ref:w,modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=t=>i.value=t),loadMore:y.value,"onUpdate:loadMore":a[2]||(a[2]=t=>y.value=t),resizeColumn:C.value,"onUpdate:resizeColumn":a[3]||(a[3]=t=>C.value=t),updatedPageCount:b.value,"onUpdate:updatedPageCount":a[4]||(a[4]=t=>b.value=t),doctype:"CRM Organization",showElement:!0,placeholderText:n.__("Search organization"),docSelect:$.value},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount","placeholderText","docSelect"]),i.value.data&&x.value.length?(u(),O(Ve,{key:0,ref_key:"organizationsListView",ref:z,modelValue:i.value.data.page_length_count,"onUpdate:modelValue":a[5]||(a[5]=t=>i.value.data.page_length_count=t),list:i.value,"onUpdate:list":a[6]||(a[6]=t=>i.value=t),rows:x.value,columns:i.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:i.value.data.row_count,totalCount:i.value.data.total_count},onLoadMore:a[7]||(a[7]=()=>y.value++),onColumnWidthUpdated:a[8]||(a[8]=()=>C.value++),onUpdatePageCount:a[9]||(a[9]=t=>b.value=t),onApplyFilter:a[10]||(a[10]=t=>w.value.applyFilter(t)),"onUpdate:selections":a[11]||(a[11]=t=>A(t))},null,8,["modelValue","list","rows","columns","options"])):i.value.data?(u(),v("div",$e,[S("div",xe,[s(ne,{class:"h-10 w-10"}),S("span",null,U(n.__("No {0} Found",[n.__("organizations")])),1),s(e,{label:n.__("Create"),onClick:a[12]||(a[12]=t=>c.value=!0)},{prefix:m(()=>[s(l,{name:"plus",class:"h-4"})]),_:1},8,["label"])])])):L("",!0),s(re,{modelValue:c.value,"onUpdate:modelValue":a[13]||(a[13]=t=>c.value=t)},null,8,["modelValue"])],64)}}};export{Ee as default};
//# sourceMappingURL=Organizations-4f1419bb.js.map
