import{_ as W}from"./CustomActions-fff8b307.js";import{m as z,u as D,a as q,g as I,w as O,r as n,o as J,s as G,c as j,b as N,d as E,e as d,f as y,h as o,i as m,j as c,F as M,k as H,l as U,t as K,v as L,x as B,D as Q,A as X,q as R,N as Y,M as Z,V as ee,R as te}from"./index-c24d0e80.js";import{_ as le,a as ae}from"./LayoutHeader-f4141a44.js";/* empty css                                                                       */import"./index-4e648177.js";import{_ as oe}from"./EditValueModal-bceb3ae7.js";import{_ as se,a as ne,b as ue,c as ie,d as re,e as de}from"./ListView-137a8729.js";import{_ as me}from"./DatePicker-dafc153c.js";import{_ as pe}from"./EmailTemplateModal-258b37b4.js";import"./label-0a4351d9.js";const ce=["onClick"],fe={key:1,class:"truncate text-base"},ve={key:2},_e=["onClick"],Ce={__name:"EmailTemplatesListView",props:z({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:z(["loadMore","updatePageCount","showEmailTemplate","columnWidthUpdated","applyFilter"],["update:modelValue","update:list"]),setup(u,{expose:x,emit:k}){const a=k,V=D(u,"modelValue"),v=D(u,"list"),h=q(),{$dialog:A}=I();O(V,(l,e)=>{l!==e&&a("updatePageCount",l)});const w=n(!1),_=n([]),b=n(()=>{});function F(l,e){_.value=l,w.value=!0,b.value=e}function i(l,e){A({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s)?",[l.size]),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:r=>{j("frappe.desk.reportview.delete_items",{items:JSON.stringify(Array.from(l)),doctype:"Email Template"}).then(()=>{N({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),e(),v.value.reload(),r()})}}]})}const t=n([]);function p(l,e){return[{label:__("Edit"),onClick:()=>F(l,e)},{label:__("Delete"),onClick:()=>i(l,e)}]}return J(()=>{var l,e,r;(l=v.value)!=null&&l.data&&(G(v.value.data,{list:v.value,call:j,createToast:N,$dialog:A,router:h}),t.value=((r=(e=v.value)==null?void 0:e.data)==null?void 0:r.listActions)||[])}),x({customListActions:t}),(l,e)=>{const r=E("Badge"),C=E("FormControl"),P=E("Button");return d(),y(M,null,[o(c(de),{columns:u.columns,rows:u.rows,options:{onRowClick:s=>a("showEmailTemplate",s.name),selectable:u.options.selectable,showTooltip:u.options.showTooltip,resizeColumn:u.options.resizeColumn},"row-key":"name"},{default:m(()=>[o(c(se),{class:"mx-5",onColumnWidthUpdated:e[0]||(e[0]=s=>a("columnWidthUpdated"))}),o(c(ne),{id:"list-rows"},{default:m(()=>[(d(!0),y(M,null,H(u.rows,s=>(d(),U(c(ie),{class:"mx-5",key:s.name,row:s},{default:m(({idx:T,column:g,item:f})=>[o(c(ue),{item:f},{default:m(({label:S})=>[["modified","creation"].includes(g.key)?(d(),y("div",{key:0,class:"truncate text-base",onClick:$=>a("applyFilter",{event:$,idx:T,column:g,item:f})},[o(c(K),{text:f.label},{default:m(()=>[L("div",null,B(f.timeAgo),1)]),_:2},1032,["text"])],8,ce)):g.key==="status"?(d(),y("div",fe,[o(r,{variant:"subtle",theme:f.color,size:"md",label:f.label,onClick:$=>a("applyFilter",{event:$,idx:T,column:g,item:f})},null,8,["theme","label","onClick"])])):g.type==="Check"?(d(),y("div",ve,[o(C,{type:"checkbox",modelValue:f,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):(d(),y("div",{key:3,class:"truncate text-base",onClick:$=>a("applyFilter",{event:$,idx:T,column:g,item:f})},B(l.__(S)),9,_e))]),_:2},1032,["item"])]),_:2},1032,["row"]))),128))]),_:1}),o(c(re),null,{actions:m(({selections:s,unselectAll:T})=>[o(c(Q),{options:p(s,T)},{default:m(()=>[o(P,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),o(c(me),{class:"border-t px-5 py-2",modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=s=>V.value=s),options:{rowCount:u.options.rowCount,totalCount:u.options.totalCount},onLoadMore:e[2]||(e[2]=s=>a("loadMore"))},null,8,["modelValue","options"]),o(oe,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=s=>w.value=s),unselectAll:b.value,"onUpdate:unselectAll":e[4]||(e[4]=s=>b.value=s),doctype:"Email Template",selectedValues:_.value,onReload:e[5]||(e[5]=s=>v.value.reload())},null,8,["modelValue","unselectAll","selectedValues"])],64)}}},ye={key:1,class:"flex h-full items-center justify-center"},we={class:"flex flex-col items-center gap-3 text-xl font-medium text-gray-500"},Fe={__name:"EmailTemplates",setup(u){const x=[{label:__("Email Templates"),route:{name:"Email Templates"}}],k=n(null),a=n({}),V=n(1),v=n(1),h=n(20),A=n(null),w=X(()=>{var i,t,p;return(t=(i=a.value)==null?void 0:i.data)!=null&&t.data?(p=a.value)==null?void 0:p.data.data.map(l=>{var r;let e={};return(r=a.value)==null||r.data.rows.forEach(C=>{e[C]=l[C],["modified","creation"].includes(C)&&(e[C]={label:Y(l[C],te),timeAgo:Z(l[C])})}),e}):[]}),_=n(!1),b=n({subject:"",response:"",name:"",enabled:1,owner:"",reference_doctype:"CRM Deal"});function F(i){var p;let t=(p=w.value)==null?void 0:p.find(l=>l.name===i);b.value={subject:t.subject,response:t.response,name:t.name,enabled:t.enabled,owner:t.owner,reference_doctype:t.reference_doctype},_.value=!0}return(i,t)=>{const p=E("FeatherIcon"),l=E("Button");return d(),y(M,null,[o(le,null,{"left-header":m(()=>[o(c(ae),{items:x})]),"right-header":m(()=>{var e;return[(e=k.value)!=null&&e.customListActions?(d(),U(W,{key:0,actions:k.value.customListActions},null,8,["actions"])):R("",!0),o(l,{variant:"solid",label:i.__("Create"),onClick:t[0]||(t[0]=r=>_.value=!0)},{prefix:m(()=>[o(p,{name:"plus",class:"h-4"})]),_:1},8,["label"])]}),_:1}),a.value.data&&w.value.length?(d(),U(Ce,{key:0,ref_key:"emailTemplatesListView",ref:k,modelValue:a.value.data.page_length_count,"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.data.page_length_count=e),list:a.value,"onUpdate:list":t[2]||(t[2]=e=>a.value=e),rows:w.value,columns:a.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:a.value.data.row_count,totalCount:a.value.data.total_count},onLoadMore:t[3]||(t[3]=()=>V.value++),onColumnWidthUpdated:t[4]||(t[4]=()=>v.value++),onUpdatePageCount:t[5]||(t[5]=e=>h.value=e),onShowEmailTemplate:F,onApplyFilter:t[6]||(t[6]=e=>A.value.applyFilter(e))},null,8,["modelValue","list","rows","columns","options"])):a.value.data?(d(),y("div",ye,[L("div",we,[o(ee,{class:"h-10 w-10"}),L("span",null,B(i.__("No {0} Found",[i.__("Email Templates")])),1),o(l,{label:i.__("Create"),onClick:t[7]||(t[7]=e=>_.value=!0)},{prefix:m(()=>[o(p,{name:"plus",class:"h-4"})]),_:1},8,["label"])])])):R("",!0),o(pe,{modelValue:_.value,"onUpdate:modelValue":t[8]||(t[8]=e=>_.value=e),reloadEmailTemplates:a.value,"onUpdate:reloadEmailTemplates":t[9]||(t[9]=e=>a.value=e),emailTemplate:b.value},null,8,["modelValue","reloadEmailTemplates","emailTemplate"])],64)}}};export{Fe as default};
//# sourceMappingURL=EmailTemplates-aa1835f3.js.map
