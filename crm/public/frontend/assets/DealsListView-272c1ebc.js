import{_ as j}from"./statuses-725e45e6.js";import{I as O}from"./IndicatorIcon-42fe5203.js";import{m as L,u as R,a as J,g as G,w as H,r as v,o as K,s as Q,c as x,b as A,d as z,e as l,f as i,h as n,i as m,j as r,F as U,k as X,l as k,n as I,_ as E,p as C,P as Y,q as Z,t as ee,v as N,D as te}from"./index-57f524e0.js";import{_ as ae}from"./EditValueModal-38ec6b00.js";import{_ as le,a as se,b as oe,c as ne,d as ie,e as re}from"./ListView-59a15338.js";import{_ as ue}from"./DatePicker-c2c1e28a.js";const de={key:0,class:"flex items-center"},ce={key:0},me={key:1},_e={key:2},pe={key:3},fe=["onClick"],ke={key:1,class:"truncate text-base"},ye={key:2},ve=["onClick"],$e={__name:"DealsListView",props:L({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:L(["loadMore","updatePageCount","columnWidthUpdated","applyFilter"],["update:modelValue","update:list"]),setup(u,{expose:P,emit:T}){const _=T,b=R(u,"modelValue"),c=R(u,"list"),D=J(),{$dialog:w}=G();H(b,(a,e)=>{a!==e&&_("updatePageCount",a)});const h=v(!1),M=v([]),V=v(()=>{});function q(a,e){M.value=a,h.value=!0,V.value=e}function S(a,e){w({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s)?",[a.size]),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:d=>{x("frappe.desk.reportview.delete_items",{items:JSON.stringify(Array.from(a)),doctype:"CRM Deal"}).then(()=>{A({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),e(),c.value.reload(),d()})}}]})}const B=v([]),F=v([]);function W(a,e){let d=[{label:__("Edit"),onClick:()=>q(a,e)},{label:__("Delete"),onClick:()=>S(a,e)}];return B.value.forEach(p=>{d.push({label:__(p.label),onClick:()=>p.onClick({list:c.value,selections:a,unselectAll:e,call:x,createToast:A,$dialog:w,router:D})})}),d}return K(()=>{var a,e,d,p,g;(a=c.value)!=null&&a.data&&(Q(c.value.data,{list:c.value,call:x,createToast:A,$dialog:w,router:D}),B.value=((d=(e=c.value)==null?void 0:e.data)==null?void 0:d.bulkActions)||[],F.value=((g=(p=c.value)==null?void 0:p.data)==null?void 0:g.listActions)||[])}),P({customListActions:F}),(a,e)=>{const d=z("Badge"),p=z("FormControl"),g=z("Button");return l(),i(U,null,[n(r(re),{class:I(a.$attrs.class),columns:u.columns,rows:u.rows,options:{getRowRoute:s=>({name:"Deal",params:{dealId:s.name}}),selectable:u.options.selectable,showTooltip:u.options.showTooltip,resizeColumn:u.options.resizeColumn},"row-key":"name"},{default:m(()=>[n(r(le),{class:"mx-5",onColumnWidthUpdated:e[0]||(e[0]=s=>_("columnWidthUpdated"))}),n(r(se),{id:"list-rows"},{default:m(()=>[(l(!0),i(U,null,X(u.rows,s=>(l(),k(r(ne),{class:"mx-5",key:s.name,row:s},{default:m(({idx:f,column:o,item:t})=>[o.key==="_assign"?(l(),i("div",de,[n(j,{avatars:t,size:"sm",onClick:$=>_("applyFilter",{event:$,idx:f,column:o,item:t})},null,8,["avatars","onClick"])])):(l(),k(r(oe),{key:1,item:t},{prefix:m(()=>[o.key==="status"?(l(),i("div",ce,[n(O,{class:I(t.color)},null,8,["class"])])):o.key==="organization"?(l(),i("div",me,[t.label?(l(),k(r(E),{key:0,class:"flex items-center",image:t.logo,label:t.label,size:"sm"},null,8,["image","label"])):C("",!0)])):o.key==="deal_owner"?(l(),i("div",_e,[t.full_name?(l(),k(r(E),{key:0,class:"flex items-center",image:t.user_image,label:t.full_name,size:"sm"},null,8,["image","label"])):C("",!0)])):o.key==="mobile_no"?(l(),i("div",pe,[n(Y,{class:"h-4 w-4"})])):C("",!0)]),default:m(({label:$})=>[["modified","creation","first_response_time","first_responded_on","response_by"].includes(o.key)?(l(),i("div",{key:0,class:"truncate text-base",onClick:y=>_("applyFilter",{event:y,idx:f,column:o,item:t})},[n(r(Z),{text:t.label},{default:m(()=>[ee("div",null,N(t.timeAgo),1)]),_:2},1032,["text"])],8,fe)):o.key==="sla_status"?(l(),i("div",ke,[t.value?(l(),k(d,{key:0,variant:"subtle",theme:t.color,size:"md",label:t.value,onClick:y=>_("applyFilter",{event:y,idx:f,column:o,item:t})},null,8,["theme","label","onClick"])):C("",!0)])):o.type==="Check"?(l(),i("div",ye,[n(p,{type:"checkbox",modelValue:t,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):(l(),i("div",{key:3,class:"truncate text-base",onClick:y=>_("applyFilter",{event:y,idx:f,column:o,item:t})},N(a.__($)),9,ve))]),_:2},1032,["item"]))]),_:2},1032,["row"]))),128))]),_:1}),n(r(ie),null,{actions:m(({selections:s,unselectAll:f})=>[n(r(te),{options:W(s,f)},{default:m(()=>[n(g,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),b.value?(l(),k(r(ue),{key:0,class:"border-t px-5 py-2",modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=s=>b.value=s),options:{rowCount:u.options.rowCount,totalCount:u.options.totalCount},onLoadMore:e[2]||(e[2]=s=>_("loadMore"))},null,8,["modelValue","options"])):C("",!0),n(ae,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=s=>h.value=s),unselectAll:V.value,"onUpdate:unselectAll":e[4]||(e[4]=s=>V.value=s),doctype:"CRM Deal",selectedValues:M.value,onReload:e[5]||(e[5]=s=>c.value.reload())},null,8,["modelValue","unselectAll","selectedValues"])],64)}}};export{$e as _};
//# sourceMappingURL=DealsListView-272c1ebc.js.map
