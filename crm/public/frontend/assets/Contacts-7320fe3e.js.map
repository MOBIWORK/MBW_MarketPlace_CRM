{"version":3,"file":"Contacts-7320fe3e.js","sources":["../../../../frontend/src/pages/Contacts.vue"],"sourcesContent":["<template>\n  <LayoutHeader>\n    <template #left-header>\n      <Breadcrumbs :items=\"breadcrumbs\" />\n    </template>\n    <template #right-header>\n      <CustomActions\n        v-if=\"contactsListView?.customListActions\"\n        :actions=\"contactsListView.customListActions\"\n      />\n      <Button\n        variant=\"solid\"\n        :label=\"__('Create')\"\n        @click=\"showContactModal = true\"\n      >\n        <template #prefix><FeatherIcon name=\"plus\" class=\"h-4\" /></template>\n      </Button>\n    </template>\n  </LayoutHeader>\n  <ViewControls\n    ref=\"viewControls\"\n    v-model=\"contacts\"\n    v-model:loadMore=\"loadMore\"\n    v-model:resizeColumn=\"triggerResize\"\n    v-model:updatedPageCount=\"updatedPageCount\"\n    doctype=\"Contact\"\n    :showElement=true\n    :placeholderText=\"__('Search customer')\"\n  />\n  <ContactsListView\n    ref=\"contactsListView\"\n    v-if=\"contacts.data && rows.length\"\n    v-model=\"contacts.data.page_length_count\"\n    v-model:list=\"contacts\"\n    :rows=\"rows\"\n    :columns=\"contacts.data.columns\"\n    :options=\"{\n      showTooltip: false,\n      resizeColumn: true,\n      rowCount: contacts.data.row_count,\n      totalCount: contacts.data.total_count,\n    }\"\n    @loadMore=\"() => loadMore++\"\n    @columnWidthUpdated=\"() => triggerResize++\"\n    @updatePageCount=\"(count) => (updatedPageCount = count)\"\n    @applyFilter=\"(data) => viewControls.applyFilter(data)\"\n  />\n  <div\n    v-else-if=\"contacts.data\"\n    class=\"flex h-full items-center justify-center\"\n  >\n    <div\n      class=\"flex flex-col items-center gap-3 text-xl font-medium text-gray-500\"\n    >\n      <ContactsIcon class=\"h-10 w-10\" />\n      <span>{{ __('No {0} Found', [__('Contacts')]) }}</span>\n      <Button :label=\"__('Create')\" @click=\"showContactModal = true\">\n        <template #prefix><FeatherIcon name=\"plus\" class=\"h-4\" /></template>\n      </Button>\n    </div>\n  </div>\n  <ContactModal v-model=\"showContactModal\" :contact=\"{}\" />\n</template>\n\n<script setup>\nimport CustomActions from '@/components/CustomActions.vue'\nimport ContactsIcon from '@/components/Icons/ContactsIcon.vue'\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport ContactModal from '@/components/Modals/ContactModal.vue'\nimport ContactsListView from '@/components/ListViews/ContactsListView.vue'\nimport ViewControls from '@/components/ViewControls.vue'\nimport { Breadcrumbs } from 'frappe-ui'\nimport { organizationsStore } from '@/stores/organizations.js'\nimport { dateFormat, dateTooltipFormat, timeAgo } from '@/utils'\nimport { ref, computed } from 'vue'\nimport { useRoute } from 'vue-router'\n\nconst { getOrganization } = organizationsStore()\nconst route = useRoute()\n\nconst showContactModal = ref(false)\n\nconst currentContact = computed(() => {\n  return contacts.value?.data?.data?.find(\n    (contact) => contact.name === route.params.contactId\n  )\n})\n\nconst breadcrumbs = computed(() => {\n  let items = [{ label: __('Contacts'), route: { name: 'Contacts' } }]\n  if (!currentContact.value) return items\n  items.push({\n    label: __(currentContact.value.full_name),\n    route: {\n      name: 'Contact',\n      params: { contactId: currentContact.value.name },\n    },\n  })\n  return items\n})\n\nconst contactsListView = ref(null)\n\n// contacts data is loaded in the ViewControls component\nconst contacts = ref({})\nconst loadMore = ref(1)\nconst triggerResize = ref(1)\nconst updatedPageCount = ref(20)\nconst viewControls = ref(null)\n\nconst columns = computed(() => {\n  return contacts.value?.data.columns.forEach(field => {\n    if (field.key === 'full_name') {\n        field.key = 'first_name';\n    }\n});\n})\nconst rows = computed(() => {\n  if (!contacts.value?.data?.data) return []\n  return contacts.value?.data.data.map((contact) => {\n    let _rows = {}\n    contacts.value?.data.rows.forEach((row) => {\n      _rows[row] = contact[row]\n\n      if (row == 'first_name') {\n        _rows[row] = {\n          label: contact.first_name,\n          image_label: contact.first_name,\n          image: contact.image,\n        }\n      } else if (row == 'company_name') {\n        _rows[row] = {\n          label: contact.company_name,\n          logo: getOrganization(contact.company_name)?.organization_logo,\n        }\n      } else if (['modified', 'creation'].includes(row)) {\n        _rows[row] = {\n          label: dateFormat(contact[row], dateTooltipFormat),\n          timeAgo: __(timeAgo(contact[row])),\n        }\n      }\n    })\n    return _rows\n  })\n})\n\n</script>\n"],"names":["getOrganization","organizationsStore","route","useRoute","showContactModal","ref","currentContact","computed","_c","_b","_a","contacts","contact","breadcrumbs","items","contactsListView","loadMore","triggerResize","updatedPageCount","viewControls","field","rows","_rows","row","dateFormat","dateTooltipFormat","timeAgo"],"mappings":"62BA6EA,KAAM,CAAE,gBAAAA,CAAiB,EAAGC,EAAoB,EAC1CC,EAAQC,EAAU,EAElBC,EAAmBC,EAAI,EAAK,EAE5BC,EAAiBC,EAAS,IAAM,WACpC,OAAOC,GAAAC,GAAAC,EAAAC,EAAS,QAAT,YAAAD,EAAgB,OAAhB,YAAAD,EAAsB,OAAtB,YAAAD,EAA4B,KAChCI,GAAYA,EAAQ,OAASV,EAAM,OAAO,UAE/C,CAAC,EAEKW,EAAcN,EAAS,IAAM,CACjC,IAAIO,EAAQ,CAAC,CAAE,MAAO,GAAG,UAAU,EAAG,MAAO,CAAE,KAAM,UAAU,EAAI,EACnE,OAAKR,EAAe,OACpBQ,EAAM,KAAK,CACT,MAAO,GAAGR,EAAe,MAAM,SAAS,EACxC,MAAO,CACL,KAAM,UACN,OAAQ,CAAE,UAAWA,EAAe,MAAM,IAAM,CACjD,CACL,CAAG,EACMQ,CACT,CAAC,EAEKC,EAAmBV,EAAI,IAAI,EAG3BM,EAAWN,EAAI,EAAE,EACjBW,EAAWX,EAAI,CAAC,EAChBY,EAAgBZ,EAAI,CAAC,EACrBa,EAAmBb,EAAI,EAAE,EACzBc,EAAed,EAAI,IAAI,EAEbE,EAAS,IAAM,OAC7B,OAAOG,EAAAC,EAAS,QAAT,YAAAD,EAAgB,KAAK,QAAQ,QAAQU,GAAS,CAC/CA,EAAM,MAAQ,cACdA,EAAM,IAAM,aAEpB,EACA,CAAC,EACD,MAAMC,EAAOd,EAAS,IAAM,WAC1B,OAAKE,GAAAC,EAAAC,EAAS,QAAT,YAAAD,EAAgB,OAAhB,MAAAD,EAAsB,MACpBD,EAAAG,EAAS,QAAT,YAAAH,EAAgB,KAAK,KAAK,IAAKI,GAAY,OAChD,IAAIU,EAAQ,CAAE,EACd,OAAAZ,EAAAC,EAAS,QAAT,MAAAD,EAAgB,KAAK,KAAK,QAASa,GAAQ,OACzCD,EAAMC,CAAG,EAAIX,EAAQW,CAAG,EAEpBA,GAAO,aACTD,EAAMC,CAAG,EAAI,CACX,MAAOX,EAAQ,WACf,YAAaA,EAAQ,WACrB,MAAOA,EAAQ,KAChB,EACQW,GAAO,eAChBD,EAAMC,CAAG,EAAI,CACX,MAAOX,EAAQ,aACf,MAAMF,EAAAV,EAAgBY,EAAQ,YAAY,IAApC,YAAAF,EAAuC,iBAC9C,EACQ,CAAC,WAAY,UAAU,EAAE,SAASa,CAAG,IAC9CD,EAAMC,CAAG,EAAI,CACX,MAAOC,EAAWZ,EAAQW,CAAG,EAAGE,CAAiB,EACjD,QAAS,GAAGC,EAAQd,EAAQW,CAAG,CAAC,CAAC,CAClC,EAET,GACWD,CACX,GAzB0C,CAAE,CA0B5C,CAAC"}