import{m as w,u as x,r as u,w as k,d as b,e as N,l as U,i as S,v as t,E as g,x as f,h as s,j as n,I as B,aM as I,bm as q,c as y,aC as O}from"./index-b29292c2.js";const J={class:"flex flex-col gap-4"},P={class:"flex gap-4"},$={class:"flex-1"},z={class:"mb-1.5 text-sm text-gray-600"},F=t("span",{class:"text-red-500"},"*",-1),L={class:"flex-1"},W={class:"mb-1.5 text-sm text-gray-600"},A={class:"mb-1.5 text-sm text-gray-600"},G=t("span",{class:"text-red-500"},"*",-1),H={class:"mb-1.5 text-sm text-gray-600"},K=t("span",{class:"text-red-500"},"*",-1),Y={__name:"EmailTemplateModal",props:w({emailTemplate:{type:Object,default:{}}},{modelValue:{},modelModifiers:{},reloadEmailTemplates:{},reloadEmailTemplatesModifiers:{}}),emits:w(["after"],["update:modelValue","update:reloadEmailTemplates"]),setup(c,{emit:Q}){const v=c,r=x(c,"modelValue"),C=x(c,"reloadEmailTemplates"),i=u(""),h=u(null),T=u(null),d=u(!1);let a=u({});async function M(){if(!E())return;const e={...v.emailTemplate},l={...a.value},m=e.name!==l.name;delete e.name,delete l.name;const p=JSON.stringify(e)!==JSON.stringify(l),_=l;if(!m&&!p){r.value=!1;return}m&&await R(),p&&await j(_),V()}async function R(){return await y("frappe.client.rename_doc",{doctype:"Email Template",old_name:v.emailTemplate.name,new_name:a.value.name})}async function j(e){return(await y("frappe.client.set_value",{doctype:"Email Template",name:a.value.name,fieldname:e})).name}async function D(){if(!E())return;(await y("frappe.client.insert",{doc:{doctype:"Email Template",...a.value}})).name&&V()}function V(e){var l;(l=C.value)==null||l.reload(),r.value=!1}function E(){return a.value.name?a.value.subject?!a.value.response||a.value.response==="<p></p>"?(i.value="Content is required",!1):!0:(i.value="Subject is required",!1):(i.value="Name is required",!1)}return k(()=>r.value,e=>{e&&(d.value=!1,i.value="",O(()=>{a.value.name?h.value.el.focus():T.value.el.focus(),a.value={...v.emailTemplate},a.value.name&&(d.value=!0)}))}),(e,l)=>{const m=b("TextInput"),p=b("ErrorMessage"),_=b("Dialog");return N(),U(_,{modelValue:r.value,"onUpdate:modelValue":l[5]||(l[5]=o=>r.value=o),options:{title:d.value?e.__(c.emailTemplate.name):e.__("Create Email Template"),size:"xl",actions:[{label:d.value?e.__("Update"):e.__("Create"),variant:"solid",onClick:()=>d.value?M():D()}]}},{"body-content":S(()=>[t("div",J,[t("div",P,[t("div",$,[t("div",z,[g(f(e.__("Name"))+" ",1),F]),s(m,{ref_key:"nameRef",ref:T,variant:"outline",modelValue:n(a).name,"onUpdate:modelValue":l[0]||(l[0]=o=>n(a).name=o),placeholder:e.__("Payment Reminder")},null,8,["modelValue","placeholder"])]),t("div",L,[t("div",W,f(e.__("Doctype")),1),s(n(B),{variant:"outline",modelValue:n(a).reference_doctype,"onUpdate:modelValue":l[1]||(l[1]=o=>n(a).reference_doctype=o),options:["CRM Deal","CRM Lead"],placeholder:e.__("CRM Deal")},null,8,["modelValue","placeholder"])])]),t("div",null,[t("div",A,[g(f(e.__("Subject"))+" ",1),G]),s(m,{ref_key:"subjectRef",ref:h,variant:"outline",modelValue:n(a).subject,"onUpdate:modelValue":l[2]||(l[2]=o=>n(a).subject=o),placeholder:e.__("Payment Reminder from - (#{{ name }})")},null,8,["modelValue","placeholder"])]),t("div",null,[t("div",H,[g(f(e.__("Content"))+" ",1),K]),s(n(I),{variant:"outline",ref:"content","editor-class":"!prose-sm overflow-auto min-h-[180px] max-h-80 py-1.5 px-2 rounded border border-gray-300 bg-white hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400 text-gray-800 transition-colors",bubbleMenu:!0,content:n(a).response,onChange:l[3]||(l[3]=o=>n(a).response=o),placeholder:e.__(`Dear {{ lead_name }} 

This is a reminder for the payment of {{ grand_total }}. 

Thanks 
MBW Cloud`)},null,8,["content","placeholder"])]),t("div",null,[s(n(q),{modelValue:n(a).enabled,"onUpdate:modelValue":l[4]||(l[4]=o=>n(a).enabled=o),label:e.__("Enabled")},null,8,["modelValue","label"])]),s(p,{message:e.__(i.value)},null,8,["message"])])]),_:1},8,["modelValue","options"])}}};export{Y as _};
//# sourceMappingURL=EmailTemplateModal-1b62fa8e.js.map
