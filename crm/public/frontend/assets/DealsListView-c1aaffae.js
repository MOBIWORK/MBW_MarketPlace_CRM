import{_ as O}from"./statuses-664899b3.js";import{I as J}from"./IndicatorIcon-ce0cf2c5.js";import{m as R,u as U,a as G,g as H,w as K,r as b,o as Q,s as X,c as x,b as z,d as D,e as a,f as u,h as i,i as p,j as d,F as I,k as Y,l as y,n as E,p as N,q as g,P as Z,t as ee,v as le,x as P,D as te}from"./index-8d331f57.js";import{_ as ae}from"./EditValueModal-46b7b06a.js";import{_ as se,a as oe,b as ne,c as ie,d as re,e as ue}from"./ListView-69611944.js";import{_ as de}from"./DatePicker-c339243f.js";const ce={key:0,class:"flex items-center"},me=["onClick"],_e=["onClick"],ke=["onClick"],fe=["onClick"],pe=["onClick"],ye={key:1,class:"truncate text-base"},Ce={key:2},ve=["onClick"],Ae={__name:"DealsListView",props:R({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:R(["loadMore","updatePageCount","columnWidthUpdated","applyFilter"],["update:modelValue","update:list"]),setup(c,{expose:T,emit:q}){const w=q,h=U(c,"modelValue"),k=U(c,"list"),M=G(),{$dialog:V}=H();K(h,(t,e)=>{t!==e&&w("updatePageCount",t)});const $=b(!1),F=b([]),A=b(()=>{});function f(t,e,n,_){["mobile_no","email","lead_name"].includes(n.key)||w("applyFilter",{event:t,idx:e,column:n,item:_})}function S(t,e){F.value=t,$.value=!0,A.value=e}function W(t,e){V({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s).All related documents will be deleted accordingly?",[t.size]),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:n=>{x("crm.api.doc.delete_items_for_leads_deals",{items:JSON.stringify(Array.from(t)),doctype:"CRM Deal"}).then(()=>{z({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),e(),k.value.reload(),n()})}}]})}const B=b([]),L=b([]);function j(t,e){let n=[{label:__("Edit"),onClick:()=>S(t,e)},{label:__("Delete"),onClick:()=>W(t,e)}];return B.value.forEach(_=>{n.push({label:__(_.label),onClick:()=>_.onClick({list:k.value,selections:t,unselectAll:e,call:x,createToast:z,$dialog:V,router:M})})}),n}return Q(()=>{var t,e,n,_,C;(t=k.value)!=null&&t.data&&(X(k.value.data,{list:k.value,call:x,createToast:z,$dialog:V,router:M}),B.value=((n=(e=k.value)==null?void 0:e.data)==null?void 0:n.bulkActions)||[],L.value=((C=(_=k.value)==null?void 0:_.data)==null?void 0:C.listActions)||[])}),T({customListActions:L}),(t,e)=>{const n=D("Badge"),_=D("FormControl"),C=D("Button");return a(),u(I,null,[i(d(ue),{class:E(t.$attrs.class),columns:c.columns,rows:c.rows,options:{getRowRoute:o=>({name:"Deal",params:{dealId:o.name}}),selectable:c.options.selectable,showTooltip:c.options.showTooltip,resizeColumn:c.options.resizeColumn},"row-key":"name"},{default:p(()=>[i(d(se),{class:"mx-5",onColumnWidthUpdated:e[0]||(e[0]=o=>w("columnWidthUpdated"))}),i(d(oe),{id:"list-rows"},{default:p(()=>[(a(!0),u(I,null,Y(c.rows,o=>(a(),y(d(ie),{class:"mx-5",key:o.name,row:o},{default:p(({idx:m,column:s,item:l})=>[s.key==="_assign"?(a(),u("div",ce,[i(O,{avatars:l,size:"sm",onClick:r=>f(r,m,s,l)},null,8,["avatars","onClick"])])):(a(),y(d(ne),{key:1,item:l},{prefix:p(()=>[s.key==="status"?(a(),u("div",{key:0,onClick:r=>f(r,m,s,l)},[i(J,{class:E(l.color)},null,8,["class"])],8,me)):s.key==="organization"?(a(),u("div",{key:1,onClick:r=>f(r,m,s,l)},[l.label?(a(),y(d(N),{key:0,class:"flex items-center",image:l.logo,label:l.label,size:"sm"},null,8,["image","label"])):g("",!0)],8,_e)):s.key==="deal_owner"?(a(),u("div",{key:2,onClick:r=>f(r,m,s,l)},[l.full_name?(a(),y(d(N),{key:0,class:"flex items-center",image:l.user_image,label:l.full_name,size:"sm"},null,8,["image","label"])):g("",!0)],8,ke)):s.key==="mobile_no"?(a(),u("div",{key:3,onClick:r=>f(r,m,s,l)},[i(Z,{class:"h-4 w-4"})],8,fe)):g("",!0)]),default:p(({label:r})=>[["modified","creation","first_response_time","first_responded_on","response_by"].includes(s.key)?(a(),u("div",{key:0,class:"truncate text-base",onClick:v=>f(v,m,s,l)},[i(d(ee),{text:l.label},{default:p(()=>[le("div",null,P(l.timeAgo),1)]),_:2},1032,["text"])],8,pe)):s.key==="sla_status"?(a(),u("div",ye,[l.value?(a(),y(n,{key:0,variant:"subtle",theme:l.color,size:"md",label:l.value,onClick:v=>f(v,m,s,l)},null,8,["theme","label","onClick"])):g("",!0)])):s.type==="Check"?(a(),u("div",Ce,[i(_,{type:"checkbox",modelValue:l,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):(a(),u("div",{key:3,class:"truncate text-base",onClick:v=>f(v,m,s,l)},P(t.__(r)),9,ve))]),_:2},1032,["item"]))]),_:2},1032,["row"]))),128))]),_:1}),i(d(re),null,{actions:p(({selections:o,unselectAll:m})=>[i(d(te),{options:j(o,m)},{default:p(()=>[i(C,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),h.value?(a(),y(d(de),{key:0,class:"border-t px-5 py-2",modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=o=>h.value=o),options:{rowCount:c.options.rowCount,totalCount:c.options.totalCount},onLoadMore:e[2]||(e[2]=o=>w("loadMore"))},null,8,["modelValue","options"])):g("",!0),i(ae,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=o=>$.value=o),unselectAll:A.value,"onUpdate:unselectAll":e[4]||(e[4]=o=>A.value=o),doctype:"CRM Deal",selectedValues:F.value,onReload:e[5]||(e[5]=o=>k.value.reload())},null,8,["modelValue","unselectAll","selectedValues"])],64)}}};export{Ae as _};
//# sourceMappingURL=DealsListView-c1aaffae.js.map
