import{_ as W}from"./CustomActions-4bf9057a.js";import{m as h,u as D,a as q,g as I,w as O,r as n,o as J,s as G,c as P,b as j,d as x,e as d,f as y,h as o,i as m,j as v,F,k as H,l as z,t as K,v as L,x as B,D as Q,A as X,q as N,N as Y,M as Z,V as ee,R as te}from"./index-d8c5d38f.js";import{_ as le,a as ae}from"./LayoutHeader-13bffee4.js";import{_ as oe}from"./ViewControls-05350539.js";import{_ as se}from"./EditValueModal-75518ecd.js";import{_ as ne,a as ue,b as ie,c as re,d as de,e as me}from"./ListView-ccb17f09.js";import{_ as pe}from"./DatePicker-e85256ef.js";import{_ as ce}from"./EmailTemplateModal-80cd619d.js";import"./EditIcon-4b2b470e.js";import"./DatetimePicker-5559de25.js";import"./label-78a9a0c4.js";const ve=["onClick"],fe={key:1,class:"truncate text-base"},_e={key:2},Ce=["onClick"],ye={__name:"EmailTemplatesListView",props:h({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:h(["loadMore","updatePageCount","showEmailTemplate","columnWidthUpdated","applyFilter"],["update:modelValue","update:list"]),setup(u,{expose:M,emit:V}){const l=V,w=D(u,"modelValue"),p=D(u,"list"),T=q(),{$dialog:$}=I();O(w,(a,e)=>{a!==e&&l("updatePageCount",a)});const b=n(!1),_=n([]),g=n(()=>{});function U(a,e){_.value=a,b.value=!0,g.value=e}function i(a,e){$({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s)?",[a.size]),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:r=>{P("frappe.desk.reportview.delete_items",{items:JSON.stringify(Array.from(a)),doctype:"Email Template"}).then(()=>{j({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),e(),p.value.reload(),r()})}}]})}const t=n([]);function c(a,e){return[{label:__("Edit"),onClick:()=>U(a,e)},{label:__("Delete"),onClick:()=>i(a,e)}]}return J(()=>{var a,e,r;(a=p.value)!=null&&a.data&&(G(p.value.data,{list:p.value,call:P,createToast:j,$dialog:$,router:T}),t.value=((r=(e=p.value)==null?void 0:e.data)==null?void 0:r.listActions)||[])}),M({customListActions:t}),(a,e)=>{const r=x("Badge"),C=x("FormControl"),R=x("Button");return d(),y(F,null,[o(v(me),{columns:u.columns,rows:u.rows,options:{onRowClick:s=>l("showEmailTemplate",s.name),selectable:u.options.selectable,showTooltip:u.options.showTooltip,resizeColumn:u.options.resizeColumn},"row-key":"name"},{default:m(()=>[o(v(ne),{class:"mx-5",onColumnWidthUpdated:e[0]||(e[0]=s=>l("columnWidthUpdated"))}),o(v(ue),{id:"list-rows"},{default:m(()=>[(d(!0),y(F,null,H(u.rows,s=>(d(),z(v(re),{class:"mx-5",key:s.name,row:s},{default:m(({idx:E,column:k,item:f})=>[o(v(ie),{item:f},{default:m(({label:S})=>[["modified","creation"].includes(k.key)?(d(),y("div",{key:0,class:"truncate text-base",onClick:A=>l("applyFilter",{event:A,idx:E,column:k,item:f})},[o(v(K),{text:f.label},{default:m(()=>[L("div",null,B(f.timeAgo),1)]),_:2},1032,["text"])],8,ve)):k.key==="status"?(d(),y("div",fe,[o(r,{variant:"subtle",theme:f.color,size:"md",label:f.label,onClick:A=>l("applyFilter",{event:A,idx:E,column:k,item:f})},null,8,["theme","label","onClick"])])):k.type==="Check"?(d(),y("div",_e,[o(C,{type:"checkbox",modelValue:f,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):(d(),y("div",{key:3,class:"truncate text-base",onClick:A=>l("applyFilter",{event:A,idx:E,column:k,item:f})},B(a.__(S)),9,Ce))]),_:2},1032,["item"])]),_:2},1032,["row"]))),128))]),_:1}),o(v(de),null,{actions:m(({selections:s,unselectAll:E})=>[o(v(Q),{options:c(s,E)},{default:m(()=>[o(R,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),o(v(pe),{class:"border-t px-5 py-2",modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=s=>w.value=s),options:{rowCount:u.options.rowCount,totalCount:u.options.totalCount},onLoadMore:e[2]||(e[2]=s=>l("loadMore"))},null,8,["modelValue","options"]),o(se,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),unselectAll:g.value,"onUpdate:unselectAll":e[4]||(e[4]=s=>g.value=s),doctype:"Email Template",selectedValues:_.value,onReload:e[5]||(e[5]=s=>p.value.reload())},null,8,["modelValue","unselectAll","selectedValues"])],64)}}},we={key:1,class:"flex h-full items-center justify-center"},be={class:"flex flex-col items-center gap-3 text-xl font-medium text-gray-500"},ze={__name:"EmailTemplates",setup(u){const M=[{label:__("Email Templates"),route:{name:"Email Templates"}}],V=n(null),l=n({}),w=n(1),p=n(1),T=n(20),$=n(null),b=X(()=>{var i,t,c;return(t=(i=l.value)==null?void 0:i.data)!=null&&t.data?(c=l.value)==null?void 0:c.data.data.map(a=>{var r;let e={};return(r=l.value)==null||r.data.rows.forEach(C=>{e[C]=a[C],["modified","creation"].includes(C)&&(e[C]={label:Y(a[C],te),timeAgo:Z(a[C])})}),e}):[]}),_=n(!1),g=n({subject:"",response:"",name:"",enabled:1,owner:"",reference_doctype:"CRM Deal"});function U(i){var c;let t=(c=b.value)==null?void 0:c.find(a=>a.name===i);g.value={subject:t.subject,response:t.response,name:t.name,enabled:t.enabled,owner:t.owner,reference_doctype:t.reference_doctype},_.value=!0}return(i,t)=>{const c=x("FeatherIcon"),a=x("Button");return d(),y(F,null,[o(le,null,{"left-header":m(()=>[o(v(ae),{items:M})]),"right-header":m(()=>{var e;return[(e=V.value)!=null&&e.customListActions?(d(),z(W,{key:0,actions:V.value.customListActions},null,8,["actions"])):N("",!0),o(a,{variant:"solid",label:i.__("Create"),onClick:t[0]||(t[0]=r=>_.value=!0)},{prefix:m(()=>[o(c,{name:"plus",class:"h-4"})]),_:1},8,["label"])]}),_:1}),o(oe,{ref_key:"viewControls",ref:$,modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e),loadMore:w.value,"onUpdate:loadMore":t[2]||(t[2]=e=>w.value=e),resizeColumn:p.value,"onUpdate:resizeColumn":t[3]||(t[3]=e=>p.value=e),updatedPageCount:T.value,"onUpdate:updatedPageCount":t[4]||(t[4]=e=>T.value=e),doctype:"Email Template"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),l.value.data&&b.value.length?(d(),z(ye,{key:0,ref_key:"emailTemplatesListView",ref:V,modelValue:l.value.data.page_length_count,"onUpdate:modelValue":t[5]||(t[5]=e=>l.value.data.page_length_count=e),list:l.value,"onUpdate:list":t[6]||(t[6]=e=>l.value=e),rows:b.value,columns:l.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:l.value.data.row_count,totalCount:l.value.data.total_count},onLoadMore:t[7]||(t[7]=()=>w.value++),onColumnWidthUpdated:t[8]||(t[8]=()=>p.value++),onUpdatePageCount:t[9]||(t[9]=e=>T.value=e),onShowEmailTemplate:U,onApplyFilter:t[10]||(t[10]=e=>$.value.applyFilter(e))},null,8,["modelValue","list","rows","columns","options"])):l.value.data?(d(),y("div",we,[L("div",be,[o(ee,{class:"h-10 w-10"}),L("span",null,B(i.__("No {0} Found",[i.__("Email Templates")])),1),o(a,{label:i.__("Create"),onClick:t[11]||(t[11]=e=>_.value=!0)},{prefix:m(()=>[o(c,{name:"plus",class:"h-4"})]),_:1},8,["label"])])])):N("",!0),o(ce,{modelValue:_.value,"onUpdate:modelValue":t[12]||(t[12]=e=>_.value=e),reloadEmailTemplates:l.value,"onUpdate:reloadEmailTemplates":t[13]||(t[13]=e=>l.value=e),emailTemplate:g.value},null,8,["modelValue","reloadEmailTemplates","emailTemplate"])],64)}}};export{ze as default};
//# sourceMappingURL=EmailTemplates-a35965ef.js.map
