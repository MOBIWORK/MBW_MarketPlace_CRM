import{l as b,dl as I,o as c,b as f,d as o,r as T,e as x,g as M,n as O,a as S,f as u,w as D,m as Y,v as B,T as F,y as j,bB as A,U as E,K as H,s as y,aa as W,t as w,F as C,x as k,p as L,q as U}from"./index-fd4111d0.js";const N={name:"Popover",inheritAttrs:!1,props:{show:{default:void 0},trigger:{type:String,default:"click"},hoverDelay:{type:Number,default:0},leaveDelay:{type:Number,default:0},placement:{type:String,default:"bottom-start"},popoverClass:[String,Object,Array],transition:{default:null},hideOnBlur:{default:!0}},emits:["open","close","update:show"],expose:["open","close"],data(){return{popoverContainerClass:"body-container",showPopup:!1,targetWidth:null,pointerOverTargetOrPopup:!1}},watch:{show(e){e?this.open():this.close()}},created(){if(!(typeof window>"u")&&!document.getElementById("frappeui-popper-root")){const e=document.createElement("div");e.id="frappeui-popper-root",document.body.appendChild(e)}},mounted(){this.listener=e=>{const t=e.target,n=this.$refs.reference,r=this.$refs.popover;if(t===n||t===r||(n==null?void 0:n.contains(t))||(r==null?void 0:r.contains(t)))return;if(!document.getElementById("frappeui-popper-root").contains(t))return this.close();const v=`.${this.popoverContainerClass}`,d=t==null?void 0:t.closest(v),p=n==null?void 0:n.closest(v);d&&p&&d===p&&this.close()},this.hideOnBlur&&(document.addEventListener("click",this.listener),document.addEventListener("mousedown",this.listener)),this.$nextTick(()=>{this.targetWidth=this.$refs.target.clientWidth})},beforeDestroy(){this.popper&&this.popper.destroy(),document.removeEventListener("click",this.listener),document.removeEventListener("mousedown",this.listener)},computed:{showPropPassed(){return this.show!=null},isOpen:{get(){return this.showPropPassed?this.show:this.showPopup},set(e){e=!!e,this.showPropPassed?this.$emit("update:show",e):this.showPopup=e,e===!1?this.$emit("close"):e===!0&&this.$emit("open")}},popupTransition(){let e={default:{enterActiveClass:"transition duration-150 ease-out",enterFromClass:"translate-y-1 opacity-0",enterToClass:"translate-y-0 opacity-100",leaveActiveClass:"transition duration-150 ease-in",leaveFromClass:"translate-y-0 opacity-100",leaveToClass:"translate-y-1 opacity-0"}};return typeof this.transition=="string"?e[this.transition]:this.transition}},methods:{setupPopper(){this.popper?this.updatePosition():this.popper=I(this.$refs.reference,this.$refs.popover,{placement:this.placement})},updatePosition(){this.popper&&this.popper.update()},togglePopover(e){e instanceof Event&&(e=null),e==null&&(e=!this.isOpen),e=!!e,e?this.open():this.close()},open(){this.isOpen=!0,this.$nextTick(()=>this.setupPopper())},close(){this.isOpen=!1},onMouseover(){this.pointerOverTargetOrPopup=!0,this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.trigger==="hover"&&(this.hoverDelay?this.hoverTimer=setTimeout(()=>{this.pointerOverTargetOrPopup&&this.open()},Number(this.hoverDelay)*1e3):this.open())},onMouseleave(e){this.pointerOverTargetOrPopup=!1,this.hoverTimer&&(clearTimeout(this.hoverTimer),this.hoverTimer=null),this.trigger==="hover"&&(this.leaveTimer&&clearTimeout(this.leaveTimer),this.leaveDelay?this.leaveTimer=setTimeout(()=>{this.pointerOverTargetOrPopup||this.close()},Number(this.leaveDelay)*1e3):this.pointerOverTargetOrPopup||this.close())}}},z={ref:"reference"},R={class:"rounded-lg border border-gray-100 bg-white shadow-xl"};function K(e,t,n,r,i,s){return c(),f("div",z,[o("div",{ref:"target",class:O(["flex",e.$attrs.class]),onClick:t[0]||(t[0]=(...a)=>s.updatePosition&&s.updatePosition(...a)),onFocusin:t[1]||(t[1]=(...a)=>s.updatePosition&&s.updatePosition(...a)),onKeydown:t[2]||(t[2]=(...a)=>s.updatePosition&&s.updatePosition(...a)),onMouseover:t[3]||(t[3]=(...a)=>s.onMouseover&&s.onMouseover(...a)),onMouseleave:t[4]||(t[4]=(...a)=>s.onMouseleave&&s.onMouseleave(...a))},[T(e.$slots,"target",x(M({togglePopover:s.togglePopover,updatePosition:s.updatePosition,open:s.open,close:s.close,isOpen:s.isOpen})))],34),(c(),S(A,{to:"#frappeui-popper-root"},[o("div",{ref:"popover",class:O(["relative z-[100]",[i.popoverContainerClass,n.popoverClass]]),style:j({minWidth:i.targetWidth?i.targetWidth+"px":null}),onMouseover:t[5]||(t[5]=a=>i.pointerOverTargetOrPopup=!0),onMouseleave:t[6]||(t[6]=(...a)=>s.onMouseleave&&s.onMouseleave(...a))},[u(F,x(M(s.popupTransition)),{default:D(()=>[Y(o("div",null,[T(e.$slots,"body",x(M({togglePopover:s.togglePopover,updatePosition:s.updatePosition,open:s.open,close:s.close,isOpen:s.isOpen})),()=>[o("div",R,[T(e.$slots,"body-main",x(M({togglePopover:s.togglePopover,updatePosition:s.updatePosition,open:s.open,close:s.close,isOpen:s.isOpen})))])])],512),[[B,s.isOpen]])]),_:3},16)],38)]))],512)}const q=b(N,[["render",K]]);const G={name:"DatePicker",props:["value","placeholder","formatter","readonly","inputClass","maxDate"],emits:["change"],components:{Popover:q,Select:E},data(){let e=[],t=[],n=[];for(let r=0;r<24;r++)e.push({label:r<10?`0${r}`:`${r}`,value:r});for(let r=0;r<60;r++)t.push({label:r<10?`0${r}`:`${r}`,value:r}),n.push({label:r<10?`0${r}`:`${r}`,value:r});return{currentYear:null,currentMonth:null,hour:0,minute:0,second:0,arrHour:e,arrMinute:t,arrSecond:n}},created(){this.selectCurrentMonthYear()},computed:{today(){return this.getDate()},datesAsWeeks(){let e=[],t=this.dates.slice();for(;t.length;){let n=t.splice(0,7);e.push(n)}return e},dates(){if(!(this.currentYear&&this.currentMonth))return[];let e=this.currentMonth-1,t=this.currentYear,n=this.getDate(t,e,1),r=this.getDate(t,e+1,0),i=n.getDay(),s=6-r.getDay(),a=this.getDatesAfter(n,-i),v=this.getDatesAfter(r,s),d=this.getDaysInMonth(e,t),p=this.getDatesAfter(n,d-1),h=[...a,n,...p,...v];if(h.length<42){const P=this.getDatesAfter(h.at(-1),42-h.length);h=h.concat(...P)}return h},formatMonth(){let e=this.getDate(this.currentYear,this.currentMonth-1,1);return`${__(e.toLocaleString("en-US",{month:"long"}))}, ${e.getFullYear()}`},convertMaxDate(){return this.maxDate!=null&&this.maxDate!=""&&this.maxDate!=" "?new Date(this.maxDate):null}},methods:{validDateTime(e){if(this.convertMaxDate!=null&&this.convertMaxDate!=""){const t=this.toDateOnly(e),n=this.toDateOnly(this.convertMaxDate),r=this.toDateOnly(this.today);return t<=n&&r<=t}else return!0},toDateOnly(e){const t=new Date(e);return t.setHours(0,0,0,0),t},notificationInvalidDatetime(){H({title:__("Error"),text:__("Thời gian nhắc nhở không hợp lệ"),icon:"x",iconClasses:"text-red-600"})},changeTime(){let e=this.value?this.getDate(this.value):this.getDate();this.selectDate(e,!0)},selectDate(e,t=!1,n=!1){if(!t){let r=this.value&&!n?this.getDate(this.value):this.getDate();this.hour=r.getHours(),this.minute=r.getMinutes(),this.second=r.getSeconds()}this.$emit("change",this.toValue(e))},selectCurrentMonthYear(){let e=this.value?this.getDate(this.value):this.getDate();e==="Invalid Date"&&(e=this.getDate()),this.currentYear=e.getFullYear(),this.currentMonth=e.getMonth()+1,this.hour=e.getHours(),this.minute=e.getMinutes(),this.second=e.getSeconds()},prevMonth(){this.changeMonth(-1)},nextMonth(){this.changeMonth(1)},changeMonth(e){this.currentMonth=this.currentMonth+e,this.currentMonth<1&&(this.currentMonth=12,this.currentYear=this.currentYear-1),this.currentMonth>12&&(this.currentMonth=1,this.currentYear=this.currentYear+1)},getDatesAfter(e,t){let n=1;t<0&&(n=-1,t=Math.abs(t));let r=[];for(;t;)e=this.getDate(e.getFullYear(),e.getMonth(),e.getDate()+n),r.push(e),t--;return n===-1?r.reverse():r},getDaysInMonth(e,t){let r=[31,28,31,30,31,30,31,31,30,31,30,31][e];return e===1&&this.isLeapYear(t)?29:r},isLeapYear(e){return e%400===0?!0:e%100===0?!1:e%4===0},twoDigit(e){return e.toString().padStart(2,"0")},toValue(e){return e?(e.setHours(this.hour,this.minute,this.second,0),`${e.getFullYear()}-${this.twoDigit(e.getMonth()+1)}-${this.twoDigit(e.getDate())} ${this.twoDigit(e.getHours())}:${this.twoDigit(e.getMinutes())}:${this.twoDigit(e.getSeconds())}`):""},getDate(...e){return new Date(...e)},updateDate(e){e=this.getDate(e),this.hour=e.getHours(),this.minute=e.getMinutes(),this.second=e.getSeconds(),this.selectDate(e,!0)}}},V=e=>(L("data-v-caf8f384"),e=e(),U(),e),J={class:"mt-2 w-fit select-none divide-y rounded-lg bg-white text-base shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},Q={class:"flex items-center p-1 text-gray-500"},X={class:"flex-1 text-center text-base font-medium text-gray-700"},Z={class:"flex items-center justify-center gap-1 p-1"},$={class:"flex flex-col items-center justify-center p-1 text-gray-800"},ee={class:"flex items-center text-xs uppercase"},te=["onClick"],se={class:"flex items-center justify-around gap-2 p-1"},ne={class:"flex items-center"},re=V(()=>o("span",{class:"mx-1"}," : ",-1)),ie=V(()=>o("span",{class:"mx-1"}," : ",-1)),oe={class:"flex flex-col items-center justify-center"},le={class:"slider flex min-h-4 items-center justify-center"},ae={class:"slider flex min-h-4 items-center justify-center"},ue={class:"slider flex min-h-4 items-center justify-center"},he={class:"flex justify-end p-1"};function ce(e,t,n,r,i,s){const a=y("Input"),v=y("FeatherIcon"),d=y("Button"),p=y("TextInput"),h=y("Select"),P=y("Popover");return c(),S(P,{onOpen:s.selectCurrentMonthYear,class:"flex w-full [&>div:first-child]:w-full"},{target:D(({togglePopover:m})=>[u(a,W({readonly:"",type:"text",placeholder:n.placeholder,value:n.value&&n.formatter?n.formatter(n.value):n.value,onFocus:l=>n.readonly?null:m(),class:n.inputClass},e.$attrs),null,16,["placeholder","value","onFocus","class"])]),body:D(({togglePopover:m})=>[o("div",J,[o("div",Q,[u(d,{variant:"ghost",class:"h-7 w-7",onClick:s.prevMonth},{default:D(()=>[u(v,{"stroke-width":"2",name:"chevron-left",class:"h-4 w-4"})]),_:1},8,["onClick"]),o("div",X,w(s.formatMonth),1),u(d,{variant:"ghost",class:"h-7 w-7",onClick:s.nextMonth},{default:D(()=>[u(v,{"stroke-width":"2",name:"chevron-right",class:"h-4 w-4"})]),_:1},8,["onClick"])]),o("div",Z,[u(p,{class:"text-sm",type:"text",value:n.value,onChange:l=>s.updateDate(l.target.value)||m()},null,8,["value","onChange"]),u(d,{label:e.__("Now"),class:"text-sm",onClick:l=>s.selectDate(s.getDate(),!1,!0)||m()},null,8,["label","onClick"])]),o("div",$,[o("div",ee,[(c(),f(C,null,k(["su","mo","tu","we","th","fr","sa"],(l,_)=>o("div",{class:"flex h-6 w-8 items-center justify-center text-center",key:_},w(e.__(l)),1)),64))]),(c(!0),f(C,null,k(s.datesAsWeeks,(l,_)=>(c(),f("div",{class:"flex items-center",key:_},[(c(!0),f(C,null,k(l,g=>(c(),f(C,{key:s.toValue(g)},[s.validDateTime(g)?(c(),f("div",{key:0,class:O(["flex h-8 w-8 cursor-pointer items-center justify-center rounded hover:bg-gray-50",{"text-gray-400":g.getMonth()!==i.currentMonth-1,"font-extrabold text-gray-900":s.toValue(g)===s.toValue(s.today),"bg-gray-800 text-white hover:bg-gray-800":s.toValue(g)===n.value}]),onClick:()=>{s.selectDate(g),m()}},w(g.getDate()),11,te)):(c(),f("div",{key:1,class:"flex h-8 w-8 cursor-pointer items-center justify-center rounded hover:bg-gray-50 text-gray-400",onClick:t[0]||(t[0]=()=>{s.notificationInvalidDatetime()})},w(g.getDate()),1))],64))),128))]))),128))]),o("div",se,[o("div",ne,[u(h,{options:i.arrHour,modelValue:i.hour,"onUpdate:modelValue":t[1]||(t[1]=l=>i.hour=l),onChange:t[2]||(t[2]=()=>s.changeTime())},null,8,["options","modelValue"]),re,u(h,{options:i.arrMinute,modelValue:i.minute,"onUpdate:modelValue":t[3]||(t[3]=l=>i.minute=l),onChange:t[4]||(t[4]=()=>s.changeTime())},null,8,["options","modelValue"]),ie,u(h,{options:i.arrSecond,modelValue:i.second,"onUpdate:modelValue":t[5]||(t[5]=l=>i.second=l),onChange:t[6]||(t[6]=()=>s.changeTime())},null,8,["options","modelValue"])]),o("div",oe,[o("div",le,[u(p,{modelValue:i.hour,"onUpdate:modelValue":t[7]||(t[7]=l=>i.hour=l),name:"hours",type:"range",min:"0",max:"23",step:"1",onChange:()=>s.changeTime()||m()},null,8,["modelValue","onChange"])]),o("div",ae,[u(p,{modelValue:i.minute,"onUpdate:modelValue":t[8]||(t[8]=l=>i.minute=l),name:"minutes",type:"range",min:"0",max:"59",step:"1",onChange:()=>s.changeTime()||m()},null,8,["modelValue","onChange"])]),o("div",ue,[u(p,{modelValue:i.second,"onUpdate:modelValue":t[9]||(t[9]=l=>i.second=l),name:"seconds",type:"range",min:"0",max:"59",step:"1",onChange:()=>s.changeTime()||m()},null,8,["modelValue","onChange"])])])]),o("div",he,[u(d,{label:e.__("Clear"),class:"text-sm",onClick:()=>{s.selectDate(""),m()}},null,8,["label","onClick"])])])]),_:1},8,["onOpen"])}const pe=b(G,[["render",ce],["__scopeId","data-v-caf8f384"]]);export{pe as D};
//# sourceMappingURL=DatetimePicker-76bd67f8.js.map
