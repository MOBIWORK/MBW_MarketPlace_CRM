import{z as $,A as J,B as A,C as O,D as j,E as G,G as y,H,I as K,J as M,K as z,s as F,o as l,b as r,f as n,w as c,u as a,F as U,x as Q,a as C,L as B,k as v,P as X,M as Y,d as D,t as g,N as Z,n as ee}from"./index-fd4111d0.js";import{_ as te}from"./EditValueModal-3deb1bd3.js";import{_ as oe,a as se,b as le,c as ae,e as ne,d as ie}from"./ListView-dc019d7b.js";import{_ as ue}from"./DatePicker-808a1e66.js";const re={key:0},de={key:1},ce={key:2},me=["onClick"],pe={key:1},fe={key:2},_e=["onClick"],be={__name:"ContactsListView",props:$({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:$(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","update:selections"],["update:modelValue","update:list"]),setup(i,{expose:L,emit:R}){const m=R,{getUser:S}=J(),f=A(i,"modelValue"),p=A(i,"list"),E=O(),{$dialog:V}=j();G(f,(t,e)=>{t!==e&&m("updatePageCount",t)});const k=y(!1),h=y([]),b=y(()=>{});function N(t,e){h.value=t,k.value=!0,b.value=e}function P(t,e){V({title:__("Delete"),message:__("Are you sure you want to delete {0} item(s)?",[t.size]),variant:"danger",actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:u=>{M("frappe.desk.reportview.delete_items",{items:JSON.stringify(Array.from(t)),doctype:"FCRM Contact"}).then(()=>{z({title:__("Deleted successfully"),icon:"check",iconClasses:"text-green-600"}),e(),p.value.reload(),u()})}}]})}const x=y([]);function T(t,e){return[{label:__("Edit"),onClick:()=>N(t,e)},{label:__("Delete"),onClick:()=>P(t,e)}]}function I(t){let e=[];t.forEach(u=>{e.push(u)}),m("update:selections",e)}return H(()=>{var t,e,u;(t=p.value)!=null&&t.data&&(K(p.value.data,{list:p.value,call:M,createToast:z,$dialog:V,router:E}),x.value=((u=(e=p.value)==null?void 0:e.data)==null?void 0:u.listActions)||[])}),L({customListActions:x}),(t,e)=>{const u=F("FormControl"),W=F("Button");return l(),r(U,null,[n(a(ie),{class:ee(t.$attrs.class),columns:i.columns,rows:i.rows,options:{getRowRoute:o=>({name:"Contact",params:{contactId:o.name}}),selectable:i.options.selectable,showTooltip:i.options.showTooltip,resizeColumn:i.options.resizeColumn},"row-key":"name","onUpdate:selections":e[1]||(e[1]=o=>I(o))},{default:c(()=>[n(a(oe),{class:"mx-5",onColumnWidthUpdated:e[0]||(e[0]=o=>m("columnWidthUpdated"))}),n(a(se),{id:"list-rows"},{default:c(()=>[(l(!0),r(U,null,Q(i.rows,o=>(l(),C(a(ae),{class:"mx-5",key:o.name,row:o},{default:c(({idx:_,column:d,item:s})=>[n(a(le),{item:s},{prefix:c(()=>[d.key==="full_name"?(l(),r("div",re,[s.label?(l(),C(a(B),{key:0,class:"flex items-center",image:s.image,label:s.image_label,size:"sm"},null,8,["image","label"])):v("",!0)])):d.key==="company_name"?(l(),r("div",de,[s.label?(l(),C(a(B),{key:0,class:"flex items-center",image:s.logo,label:s.label,size:"sm"},null,8,["image","label"])):v("",!0)])):d.key==="mobile_no"?(l(),r("div",ce,[n(X,{class:"h-4 w-4"})])):v("",!0)]),default:c(({label:q})=>[["modified","creation"].includes(d.key)?(l(),r("div",{key:0,class:"truncate text-base",onClick:w=>m("applyFilter",{event:w,idx:_,column:d,item:s})},[n(a(Y),{text:s.label},{default:c(()=>[D("div",null,g(s.timeAgo),1)]),_:2},1032,["text"])],8,me)):d.type==="Check"?(l(),r("div",pe,[n(u,{type:"checkbox",modelValue:s,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):["modified_by","owner"].includes(d.key)?(l(),r("div",fe,[D("div",null,g(a(S)(s).first_name),1)])):(l(),r("div",{key:3,class:"truncate text-base",onClick:w=>m("applyFilter",{event:w,idx:_,column:d,item:s})},g(t.__(q)),9,_e))]),_:2},1032,["item"])]),_:2},1032,["row"]))),128))]),_:1}),n(a(ne),null,{actions:c(({selections:o,unselectAll:_})=>[n(a(Z),{options:T(o,_)},{default:c(()=>[n(W,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),f.value?(l(),C(a(ue),{key:0,class:"border-t px-5 py-2",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=o=>f.value=o),options:{rowCount:i.options.rowCount,totalCount:i.options.totalCount},onLoadMore:e[3]||(e[3]=o=>m("loadMore"))},null,8,["modelValue","options"])):v("",!0),n(te,{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=o=>k.value=o),unselectAll:b.value,"onUpdate:unselectAll":e[5]||(e[5]=o=>b.value=o),doctype:"FCRM Contact",selectedValues:h.value,onReload:e[6]||(e[6]=o=>p.value.reload())},null,8,["modelValue","unselectAll","selectedValues"])],64)}}};export{be as _};
//# sourceMappingURL=ContactsListView-57f29a95.js.map
